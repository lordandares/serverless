"use strict";

/**
 * Script to generate service hour definitions which is otherwise tedious to
 * calculate as we store them in millisecond offsets
 * Example Input: TUE 08:00 - TUE 17:00
 */
const days = {
  MON: 0,
  TUE: 1,
  WED: 2,
  THU: 3,
  FRI: 4,
  SAT: 5,
  SUN: 6,
  MON2: 7,
  TUE2: 8
};
const MINUTES = 60000;
const HOURS = 60 * MINUTES;
const DAYS = 24 * HOURS;
const input = process.argv[2];

if (!input) {
  throw new Error('invalid input');
}

const parts = input.split(' - ');

if (parts.length < 2) {
  throw new Error('invalid input');
}

const startOffset = parse(parts[0]);
const endOffset = parse(parts[1]);
const duration = endOffset - startOffset;
const output = {
  type: 'DEFAULT',
  start: startOffset,
  end: endOffset,
  duration,
  description: input
};
console.dir(output, {
  depth: null
});

function parse(def) {
  const parts = def.split(' ');

  if (parts.length < 2) {
    throw new Error('invalid parts');
  }

  const day = days[parts[0]];
  const time = parts[1];

  if (day === undefined || day === null || !time) {
    throw new Error('invalid date/time');
  }

  const timeParts = time.split(':');
  const hour = timeParts[0];
  const minute = timeParts[1];

  if (!hour || !minute) {
    throw new Error('invalid end time');
  } // NOTE this isn't taking into account actual end of time if you target the
  // end of a minute, e.g. 23:59


  const offset = day * DAYS + hour * HOURS + minute * MINUTES;
  return offset;
}