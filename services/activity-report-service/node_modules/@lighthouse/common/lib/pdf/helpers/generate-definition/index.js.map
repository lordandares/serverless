{"version":3,"sources":["../../../../src/pdf/helpers/generate-definition/index.js"],"names":["defaults","isFunction","Promise","LIGHTHOUSE_LOGO_URL","DEFAULT_PAGE_MARGINS","DEFAULT_PAGE_ORIENTATION","DEFAULT_PAGE_SIZE","defaultFooter","defaultHeader","defaultStyles","generateDefinition","options","content","fileTitle","footer","header","logoUrl","pageMargins","pageOrientation","pageSize","styles","timestamp","timezone","type","pdfStyles","pdfInfo","title","headerPromise","pdfHeader","contentPromise","pdfContent","footerPromise","pdfFooter","promises","all","then","info","catch","err","Error","message","resolve"],"mappings":"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","sourcesContent":["import { defaults, isFunction } from 'lodash'\nimport Promise from 'bluebird'\n\nimport {\n  LIGHTHOUSE_LOGO_URL,\n  DEFAULT_PAGE_MARGINS,\n  DEFAULT_PAGE_ORIENTATION,\n  DEFAULT_PAGE_SIZE,\n} from '../../../constants'\n\nimport { defaultFooter, defaultHeader, defaultStyles } from '../'\n\nexport function generateDefinition(options) {\n  const {\n    content,\n    fileTitle,\n    footer = defaultFooter,\n    header = defaultHeader,\n    logoUrl = LIGHTHOUSE_LOGO_URL,\n    pageMargins = DEFAULT_PAGE_MARGINS,\n    pageOrientation = DEFAULT_PAGE_ORIENTATION,\n    pageSize = DEFAULT_PAGE_SIZE,\n    styles = {},\n    timestamp,\n    timezone,\n    type,\n  } = options\n\n  const pdfStyles = defaults({}, styles, defaultStyles)\n  const pdfInfo = { title: fileTitle }\n\n  const headerPromise = pdfHeader(\n    header({\n      logoUrl,\n      timestamp,\n      timezone,\n    })\n  )\n\n  const contentPromise = pdfContent(content)\n\n  const footerPromise = pdfFooter(\n    footer({\n      logoUrl: LIGHTHOUSE_LOGO_URL,\n      timestamp,\n      timezone,\n      type,\n    })\n  )\n\n  const promises = [headerPromise, contentPromise, footerPromise]\n\n  return Promise.all(promises)\n    .then(([header, content, footer]) => ({\n      header,\n      content,\n      footer,\n      info: pdfInfo,\n      pageMargins,\n      pageOrientation,\n      pageSize,\n      styles: pdfStyles,\n    }))\n    .catch(err => {\n      throw new Error(`GenerateDefinitionError: ${err.message}`)\n    })\n}\n\nfunction pdfHeader(header) {\n  if (isFunction(header)) {\n    return Promise.resolve(header())\n  }\n\n  return Promise.resolve(header)\n}\n\nfunction pdfContent(content) {\n  if (isFunction(content)) {\n    return Promise.resolve(content())\n  }\n\n  return Promise.resolve(content)\n}\n\nfunction pdfFooter(footer) {\n  if (isFunction(footer)) {\n    return Promise.resolve(footer())\n  }\n\n  return Promise.resolve(footer)\n}\n"],"file":"index.js"}