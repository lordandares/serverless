!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e=e||self).Azure=e.Azure||{},e.Azure.Identity={}))}(this,function(e){"use strict";var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,r)};function r(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})}function i(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}class a extends Error{constructor(e,t){let r={error:"unknown",error_description:"An unknown error occurred and no additional details are available."};if(function(e){return e&&"string"==typeof e.error&&"string"==typeof e.error_description}(t))r=t;else if("string"==typeof t)try{r=JSON.parse(t)}catch(n){r=400===e?{error:"authority_not_found",error_description:"The specified authority URL was not found."}:{error:"unknown_error",error_description:`An unknown error has occurred. Response body:\n\n${t}`}}else r={error:"unknown_error",error_description:"An unknown error occurred and no additional details are available."};super(`An error was returned while authenticating to Azure Active Directory (status code ${e}).\n\nMore details:\n\n${JSON.stringify(r,null,"  ")}`),this.statusCode=e,this.errorResponse=r,this.name="AuthenticationError"}}class s extends Error{constructor(e){super("Authentication failed to complete due to errors"),this.errors=e,this.name="AggregateAuthenticationError"}}class c{constructor(...e){this._sources=[],this._sources=e}getToken(e,t){return o(this,void 0,void 0,function*(){let r=null;const n=[];for(let o=0;o<this._sources.length&&null===r;o++)try{r=yield this._sources[o].getToken(e,t)}catch(e){n.push(e)}if(!r&&n.length>0)throw new s(n);return r})}}const u=new Error("EnvironmentCredential is not supported in the browser.");class l{constructor(e){throw u}getToken(e,t){throw u}}const d=new Error("ManagedIdentityCredential is not supported in the browser.");class p{constructor(e,t){throw d}getToken(e,t){return o(this,void 0,void 0,function*(){throw d})}}class h extends c{constructor(e){super(new l(e),new p(void 0,e))}}var f=Object.prototype.hasOwnProperty,m=Array.isArray,y=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),g=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},v={arrayToObject:g,assign:function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var c=a[s],u=i[c];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(t.push({obj:i,prop:c}),r.push(u))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(m(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r){if(0===e.length)return e;var n=e;if("symbol"==typeof e?n=Symbol.prototype.toString.call(e):"string"!=typeof e&&(n=String(e)),"iso-8859-1"===r)return escape(n).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var o="",i=0;i<n.length;++i){var a=n.charCodeAt(i);45===a||46===a||95===a||126===a||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?o+=n.charAt(i):a<128?o+=y[a]:a<2048?o+=y[192|a>>6]+y[128|63&a]:a<55296||a>=57344?o+=y[224|a>>12]+y[128|a>>6&63]+y[128|63&a]:(i+=1,a=65536+((1023&a)<<10|1023&n.charCodeAt(i)),o+=y[240|a>>18]+y[128|a>>12&63]+y[128|a>>6&63]+y[128|63&a])}return o},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(m(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!f.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var o=t;return m(t)&&!m(r)&&(o=g(t,n)),m(t)&&m(r)?(r.forEach(function(r,o){if(f.call(t,o)){var i=t[o];i&&"object"==typeof i&&r&&"object"==typeof r?t[o]=e(i,r,n):t.push(r)}else t[o]=r}),t):Object.keys(r).reduce(function(t,o){var i=r[o];return f.call(t,o)?t[o]=e(t[o],i,n):t[o]=i,t},o)}},w=String.prototype.replace,b=/%20/g,T={RFC1738:"RFC1738",RFC3986:"RFC3986"},E=v.assign({default:T.RFC3986,formatters:{RFC1738:function(e){return w.call(e,b,"+")},RFC3986:function(e){return String(e)}}},T),S=Object.prototype.hasOwnProperty,I={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},k=Array.isArray,C=Array.prototype.push,P=function(e,t){C.apply(e,k(t)?t:[t])},R=Date.prototype.toISOString,_=E.default,A={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:v.encode,encodeValuesOnly:!1,format:_,formatter:E.formatters[_],indices:!1,serializeDate:function(e){return R.call(e)},skipNulls:!1,strictNullHandling:!1},O=function e(t,r,n,o,i,a,s,c,u,l,d,p,h){var f,m=t;if("function"==typeof s?m=s(r,m):m instanceof Date?m=l(m):"comma"===n&&k(m)&&(m=m.join(",")),null===m){if(o)return a&&!p?a(r,A.encoder,h):r;m=""}if("string"==typeof(f=m)||"number"==typeof f||"boolean"==typeof f||"symbol"==typeof f||"bigint"==typeof f||v.isBuffer(m))return a?[d(p?r:a(r,A.encoder,h))+"="+d(a(m,A.encoder,h))]:[d(r)+"="+d(String(m))];var y,g=[];if(void 0===m)return g;if(k(s))y=s;else{var w=Object.keys(m);y=c?w.sort(c):w}for(var b=0;b<y.length;++b){var T=y[b];i&&null===m[T]||(k(m)?P(g,e(m[T],"function"==typeof n?n(r,T):r,n,o,i,a,s,c,u,l,d,p,h)):P(g,e(m[T],r+(u?"."+T:"["+T+"]"),n,o,i,a,s,c,u,l,d,p,h)))}return g},x=Object.prototype.hasOwnProperty,q={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:v.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},N=function(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},U=function(e,t,r){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/g,i=r.depth>0&&/(\[[^[\]]*])/.exec(n),a=i?n.slice(0,i.index):n,s=[];if(a){if(!r.plainObjects&&x.call(Object.prototype,a)&&!r.allowPrototypes)return;s.push(a)}for(var c=0;r.depth>0&&null!==(i=o.exec(n))&&c<r.depth;){if(c+=1,!r.plainObjects&&x.call(Object.prototype,i[1].slice(1,-1))&&!r.allowPrototypes)return;s.push(i[1])}return i&&s.push("["+n.slice(i.index)+"]"),function(e,t,r){for(var n=t,o=e.length-1;o>=0;--o){var i,a=e[o];if("[]"===a&&r.parseArrays)i=[].concat(n);else{i=r.plainObjects?Object.create(null):{};var s="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(s,10);r.parseArrays||""!==s?!isNaN(c)&&a!==s&&String(c)===s&&c>=0&&r.parseArrays&&c<=r.arrayLimit?(i=[])[c]=n:i[s]=n:i={0:n}}n=i}return n}(s,t,r)}},j={formats:E,parse:function(e,t){var r=function(e){if(!e)return q;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?q.charset:e.charset;return{allowDots:void 0===e.allowDots?q.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:q.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:q.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:q.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:q.comma,decoder:"function"==typeof e.decoder?e.decoder:q.decoder,delimiter:"string"==typeof e.delimiter||v.isRegExp(e.delimiter)?e.delimiter:q.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:q.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:q.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:q.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:q.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:q.strictNullHandling}}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var n="string"==typeof e?function(e,t){var r,n={},o=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,a=o.split(t.delimiter,i),s=-1,c=t.charset;if(t.charsetSentinel)for(r=0;r<a.length;++r)0===a[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===a[r]?c="utf-8":"utf8=%26%2310003%3B"===a[r]&&(c="iso-8859-1"),s=r,r=a.length);for(r=0;r<a.length;++r)if(r!==s){var u,l,d=a[r],p=d.indexOf("]="),h=-1===p?d.indexOf("="):p+1;-1===h?(u=t.decoder(d,q.decoder,c),l=t.strictNullHandling?null:""):(u=t.decoder(d.slice(0,h),q.decoder,c),l=t.decoder(d.slice(h+1),q.decoder,c)),l&&t.interpretNumericEntities&&"iso-8859-1"===c&&(l=N(l)),l&&t.comma&&l.indexOf(",")>-1&&(l=l.split(",")),x.call(n,u)?n[u]=v.combine(n[u],l):n[u]=l}return n}(e,r):e,o=r.plainObjects?Object.create(null):{},i=Object.keys(n),a=0;a<i.length;++a){var s=i[a],c=U(s,n[s],r);o=v.merge(o,c,r)}return v.compact(o)},stringify:function(e,t){var r,n=e,o=function(e){if(!e)return A;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||A.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=E.default;if(void 0!==e.format){if(!S.call(E.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=E.formatters[r],o=A.filter;return("function"==typeof e.filter||k(e.filter))&&(o=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:A.addQueryPrefix,allowDots:void 0===e.allowDots?A.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:A.charsetSentinel,delimiter:void 0===e.delimiter?A.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:A.encode,encoder:"function"==typeof e.encoder?e.encoder:A.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:A.encodeValuesOnly,filter:o,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:A.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:A.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:A.strictNullHandling}}(t);"function"==typeof o.filter?n=(0,o.filter)("",n):k(o.filter)&&(r=o.filter);var i,a=[];if("object"!=typeof n||null===n)return"";i=t&&t.arrayFormat in I?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var s=I[i];r||(r=Object.keys(n)),o.sort&&r.sort(o.sort);for(var c=0;c<r.length;++c){var u=r[c];o.skipNulls&&null===n[u]||P(a,O(n[u],u,s,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.formatter,o.encodeValuesOnly,o.charset))}var l=a.join(o.delimiter),d=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&("iso-8859-1"===o.charset?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),l.length>0?d+l:""}};function D(e){return e.toLowerCase()}var L=function(){function e(e){if(this._headersMap={},e)for(var t in e)this.set(t,e[t])}return e.prototype.set=function(e,t){this._headersMap[D(e)]={name:e,value:t.toString()}},e.prototype.get=function(e){var t=this._headersMap[D(e)];return t?t.value:void 0},e.prototype.contains=function(e){return!!this._headersMap[D(e)]},e.prototype.remove=function(e){var t=this.contains(e);return delete this._headersMap[D(e)],t},e.prototype.rawHeaders=function(){var e={};for(var t in this._headersMap){var r=this._headersMap[t];e[r.name.toLowerCase()]=r.value}return e},e.prototype.headersArray=function(){var e=[];for(var t in this._headersMap)e.push(this._headersMap[t]);return e},e.prototype.headerNames=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].name);return e},e.prototype.headerValues=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].value);return e},e.prototype.toJson=function(){return this.rawHeaders()},e.prototype.toString=function(){return JSON.stringify(this.toJson())},e.prototype.clone=function(){return new e(this.rawHeaders())},e}();function M(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function H(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}for(var z=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}}),F=[],B=0;B<256;++B)F[B]=(B+256).toString(16).substr(1);var V=function(e,t){var r=t||0,n=F;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")};var Q=function(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||z)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var i=0;i<16;++i)t[n+i]=o[i];return t||V(o)},W={coreHttpVersion:"1.0.0-preview.2",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}};"undefined"!=typeof process&&!!process.version&&!!process.versions&&process.versions.node;function $(e){var t={};return t.body=e.bodyAsText,t.headers=e.headers,t.status=e.status,t}function G(e){var t=e.clone();return t.headers&&t.headers.remove("authorization"),t}function J(){return Q()}function K(e,t){return new Promise(function(r){return setTimeout(function(){return r(t)},e)})}var X=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Y(e,t,r){return e&&t?e.split(t).join(r||""):e}var Z=function(){function e(e,t){void 0===e&&(e={}),this.modelMappers=e,this.isXML=t}return e.prototype.validateConstraints=function(e,t,r){var n=function(e,n){throw new Error('"'+r+'" with value "'+t+'" should satisfy the constraint "'+e+'": '+n+".")};if(e.constraints&&null!=t){var o=e.constraints,i=o.ExclusiveMaximum,a=o.ExclusiveMinimum,s=o.InclusiveMaximum,c=o.InclusiveMinimum,u=o.MaxItems,l=o.MaxLength,d=o.MinItems,p=o.MinLength,h=o.MultipleOf,f=o.Pattern,m=o.UniqueItems;if(null!=i&&t>=i&&n("ExclusiveMaximum",i),null!=a&&t<=a&&n("ExclusiveMinimum",a),null!=s&&t>s&&n("InclusiveMaximum",s),null!=c&&t<c&&n("InclusiveMinimum",c),null!=u&&t.length>u&&n("MaxItems",u),null!=l&&t.length>l&&n("MaxLength",l),null!=d&&t.length<d&&n("MinItems",d),null!=p&&t.length<p&&n("MinLength",p),null!=h&&t%h!=0&&n("MultipleOf",h),f){var y="string"==typeof f?new RegExp(f):f;"string"==typeof t&&null!==t.match(y)||n("Pattern",f)}m&&t.some(function(e,t,r){return r.indexOf(e)!==t})&&n("UniqueItems",m)}},e.prototype.serialize=function(e,t,r){var n={},o=e.type.name;r||(r=e.serializedName),null!==o.match(/^Sequence$/gi)&&(n=[]),e.isConstant&&(t=e.defaultValue);var i=e.required,a=e.nullable;if(i&&a&&void 0===t)throw new Error(r+" cannot be undefined.");if(i&&!a&&null==t)throw new Error(r+" cannot be null or undefined.");if(!i&&!1===a&&null===t)throw new Error(r+" cannot be null.");if(null==t)n=t;else if(this.validateConstraints(e,t,r),null!==o.match(/^any$/gi))n=t;else if(null!==o.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/gi))n=function(e,t,r){if(null!=r)if(null!==e.match(/^Number$/gi)){if("number"!=typeof r)throw new Error(t+" with value "+r+" must be of type number.")}else if(null!==e.match(/^String$/gi)){if("string"!=typeof r.valueOf())throw new Error(t+' with value "'+r+'" must be of type string.')}else if(null!==e.match(/^Uuid$/gi)){if("string"!=typeof r.valueOf()||(o=r,!new RegExp("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$","ig").test(o)))throw new Error(t+' with value "'+r+'" must be of type string and a valid uuid.')}else if(null!==e.match(/^Boolean$/gi)){if("boolean"!=typeof r)throw new Error(t+" with value "+r+" must be of type boolean.")}else if(null!==e.match(/^Stream$/gi)){var n=typeof r;if(!("string"===n||"function"===n||r instanceof ArrayBuffer||ArrayBuffer.isView(r)||"function"==typeof Blob&&r instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}var o;return r}(o,r,t);else if(null!==o.match(/^Enum$/gi)){n=function(e,t,r){if(!t)throw new Error("Please provide a set of allowedValues to validate "+e+" as an Enum Type.");if(!t.some(function(e){return"string"==typeof e.valueOf()?e.toLowerCase()===r.toLowerCase():e===r}))throw new Error(r+" is not a valid value for "+e+". The valid values are: "+JSON.stringify(t)+".");return r}(r,e.type.allowedValues,t)}else null!==o.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/gi)?n=function(e,t,r){if(null!=t)if(null!==e.match(/^Date$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(!e)return;"string"==typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/gi)){if(!function(e){return X.test(e)}(t))throw new Error(r+' must be a string in ISO 8601 format. Instead was "'+t+'".');t=t}return t}(o,t,r):null!==o.match(/^ByteArray$/gi)?n=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=M(t)}return t}(r,t):null!==o.match(/^Base64Url$/gi)?n=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){var r=e.length;for(;r-1>=0&&e[r-1]===t;)--r;return e.substr(0,r)}(M(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)}return t}(r,t):null!==o.match(/^Sequence$/gi)?n=function(e,t,r,n){if(!Array.isArray(r))throw new Error(n+" must be of type Array.");var o=t.type.element;if(!o||"object"!=typeof o)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n+".");for(var i=[],a=0;a<r.length;a++)i[a]=e.serialize(o,r[a],n);return i}(this,e,t,r):null!==o.match(/^Dictionary$/gi)?n=function(e,t,r,n){if("object"!=typeof r)throw new Error(n+" must be of type object.");var o=t.type.value;if(!o||"object"!=typeof o)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n+".");for(var i={},a=0,s=Object.keys(r);a<s.length;a++){var c=s[a];i[c]=e.serialize(o,r[c],n+"."+c)}return i}(this,e,t,r):null!==o.match(/^Composite$/gi)&&(n=function(e,t,r,n){var o;oe(e,t)&&(t=ne(e,t,r,"clientName"));if(null!=r){for(var i={},a=te(e,t,n),s=0,c=Object.keys(a);s<c.length;s++){var u=c[s],l=a[u];if(!l.readOnly){var d=void 0,p=i;if(e.isXML)d=l.xmlIsWrapped?l.xmlName:l.xmlElementName||l.xmlName;else{var h=ee(l.serializedName);d=h.pop();for(var f=0,m=h;f<m.length;f++){var y=m[f];null==p[y]&&null!=r[u]&&(p[y]={}),p=p[y]}}if(null!=p){var g=""!==l.serializedName?n+"."+l.serializedName:n,v=r[u],w=oe(e,t);w&&w.clientName===u&&null==v&&(v=t.serializedName);var b=e.serialize(l,v,g);void 0!==b&&null!=d&&(l.xmlIsAttribute?(p.$=p.$||{},p.$[d]=b):l.xmlIsWrapped?p[d]=((o={})[l.xmlElementName]=b,o):p[d]=b)}}}var T=t.type.additionalProperties;if(T){var E=Object.keys(a),S=function(t){E.every(function(e){return e!==t})&&(i[t]=e.serialize(T,r[t],n+'["'+t+'"]'))};for(var I in r)S(I)}return i}return r}(this,e,t,r));return n},e.prototype.deserialize=function(e,t,r){if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;var n,o=e.type.name;return r||(r=e.serializedName),null!==o.match(/^Composite$/gi)?n=function(e,t,r,n){oe(e,t)&&(t=ne(e,t,r,"serializedName"));for(var o=te(e,t,n),i={},a=[],s=0,c=Object.keys(o);s<c.length;s++){var u=c[s],l=o[u],d=ee(o[u].serializedName);a.push(d[0]);var p=l.serializedName,h=l.xmlName,f=l.xmlElementName,m=n;""!==p&&void 0!==p&&(m=n+"."+p);var y=l.headerCollectionPrefix;if(y){for(var g={},v=0,w=Object.keys(r);v<w.length;v++){var b=w[v];b.startsWith(y)&&(g[b.substring(y.length)]=e.deserialize(l.type.value,r[b],m)),a.push(b)}i[u]=g}else if(e.isXML)if(l.xmlIsAttribute&&r.$)i[u]=e.deserialize(l,r.$[h],m);else{var T=r[f||h||p];if(l.xmlIsWrapped)void 0===(T=(T=r[h])&&T[f])&&(T=[]);i[u]=e.deserialize(l,T,m)}else{for(var E=void 0,S=r,I=0,k=d;I<k.length;I++){var C=k[I];if(!S)break;S=S[C]}E=S;var P=t.type.polymorphicDiscriminator;P&&u===P.clientName&&null==E&&(E=t.serializedName);var R=void 0;Array.isArray(r[u])&&""===o[u].serializedName?(E=r[u],i=e.deserialize(l,E,m)):void 0===E&&void 0===l.defaultValue||(R=e.deserialize(l,E,m),i[u]=R)}}var _=t.type.additionalProperties;if(_){var A=function(e){for(var t in o){if(ee(o[t].serializedName)[0]===e)return!1}return!0};for(var O in r)A(O)&&(i[O]=e.deserialize(_,r[O],n+'["'+O+'"]'))}else if(r)for(var x=0,q=Object.keys(r);x<q.length;x++){u=q[x];void 0!==i[u]||a.includes(u)||re(u)||(i[u]=r[u])}return i}(this,e,t,r):(this.isXML&&null!=t.$&&null!=t._&&(t=t._),null!==o.match(/^Number$/gi)?(n=parseFloat(t),isNaN(n)&&(n=t)):null!==o.match(/^Boolean$/gi)?n="true"===t||"false"!==t&&t:null!==o.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/gi)?n=t:null!==o.match(/^(Date|DateTime|DateTimeRfc1123)$/gi)?n=new Date(t):null!==o.match(/^UnixTime$/gi)?n=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==o.match(/^ByteArray$/gi)?n=H(t):null!==o.match(/^Base64Url$/gi)?n=function(e){if(!e)return;if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return H(e=e.replace(/\-/g,"+").replace(/\_/g,"/"))}(t):null!==o.match(/^Sequence$/gi)?n=function(e,t,r,n){var o=t.type.element;if(!o||"object"!=typeof o)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n);if(r){Array.isArray(r)||(r=[r]);for(var i=[],a=0;a<r.length;a++)i[a]=e.deserialize(o,r[a],n+"["+a+"]");return i}return r}(this,e,t,r):null!==o.match(/^Dictionary$/gi)&&(n=function(e,t,r,n){var o=t.type.value;if(!o||"object"!=typeof o)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n);if(r){for(var i={},a=0,s=Object.keys(r);a<s.length;a++){var c=s[a];i[c]=e.deserialize(o,r[c],n)}return i}return r}(this,e,t,r))),e.isConstant&&(n=e.defaultValue),n},e}();function ee(e){var t=[],r="";if(e)for(var n=0,o=e.split(".");n<o.length;n++){var i=o[n];"\\"===i.charAt(i.length-1)?r+=i.substr(0,i.length-1)+".":(r+=i,t.push(r),r="")}return t}function te(e,t,r){var n=t.type.modelProperties;if(!n){var o=t.type.className;if(!o)throw new Error('Class name for model "'+r+'" is not provided in the mapper "'+JSON.stringify(t,void 0,2)+'".');var i=e.modelMappers[o];if(!i)throw new Error('mapper() cannot be null or undefined for model "'+o+'".');if(!(n=i.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(i)+'" of type "'+o+'" for object "'+r+'".')}return n}function re(e){return["$","_"].includes(e)}function ne(e,t,r,n){var o=oe(e,t);if(o){var i=o[n];if(null!=i){var a=r[i];if(null!=a){var s=t.type.uberParent||t.type.className,c=a===s?a:s+"."+a,u=e.modelMappers.discriminators[c];u&&(t=u)}}}return t}function oe(e,t){return t.type.polymorphicDiscriminator||ie(e,t.type.uberParent)||ie(e,t.type.className)}function ie(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}var ae,se=function(e){for(var t={},r=0,n=e;r<n.length;r++){var o=n[r];t[o]=o}return t}(["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"]),ce=function(){function e(e,t,r,n,o,i,a,s,c,u,l,d,p){this.streamResponseBody=i,this.url=e||"",this.method=t||"GET",this.headers=o instanceof L?o:new L(o),this.body=r,this.query=n,this.formData=void 0,this.withCredentials=a||!1,this.abortSignal=s,this.timeout=c||0,this.onUploadProgress=u,this.onDownloadProgress=l,this.proxySettings=d,this.keepAlive=p}return e.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},e.prototype.prepare=function(e){if(!e)throw new Error("options object is required");if(null==e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||null!=e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){var t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){var r=e.pathTemplate,n=e.pathParameters;if("string"!=typeof r)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");var o=e.baseUrl,i=o+(o.endsWith("/")?"":"/")+(r.startsWith("/")?r.slice(1):r),a=i.match(/({\w*\s*\w*})/gi);if(a&&a.length){if(!n)throw new Error("pathTemplate: "+r+" has been provided. Hence, options.pathParameters must also be provided.");a.forEach(function(e){var t=e.slice(1,-1),o=n[t];if(null==o||"string"!=typeof o&&"object"!=typeof o){var a=JSON.stringify(n,void 0,2);throw new Error("pathTemplate: "+r+" contains the path parameter "+t+" however, it is not present in parameters: "+a+'.The value of the path parameter can either be a "string" of the form { '+t+': "some sample value" } or it can be an "object" of the form { "'+t+'": { value: "some sample value", skipUrlEncoding: true } }.')}if("string"==typeof o.valueOf()&&(i=i.replace(e,encodeURIComponent(o))),"object"==typeof o.valueOf()){if(!o.value)throw new Error("options.pathParameters["+t+'] is of type "object" but it does not contain a "value" property.');i=o.skipUrlEncoding?i.replace(e,o.value):i.replace(e,encodeURIComponent(o.value))}})}this.url=i}if(e.queryParameters){var s=e.queryParameters;if("object"!=typeof s)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var c=[];for(var u in this.query={},s){var l=s[u];if(l)if("string"==typeof l)c.push(u+"="+encodeURIComponent(l)),this.query[u]=encodeURIComponent(l);else if("object"==typeof l){if(!l.value)throw new Error("options.queryParameters["+u+'] is of type "object" but it does not contain a "value" property.');l.skipUrlEncoding?(c.push(u+"="+l.value),this.query[u]=l.value):(c.push(u+"="+encodeURIComponent(l.value)),this.query[u]=encodeURIComponent(l.value))}}this.url+=c.join("&")}if(e.headers)for(var d=e.headers,p=0,h=Object.keys(e.headers);p<h.length;p++){var f=h[p];this.headers.set(f,d[f])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",J()),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,null!=e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new Z(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this},e.prototype.clone=function(){var t=new e(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive);return this.formData&&(t.formData=this.formData),this.operationSpec&&(t.operationSpec=this.operationSpec),this.shouldDeserialize&&(t.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(t.operationResponseGetter=this.operationResponseGetter),t},e}(),ue=function(e){function t(r,n,o,i,a,s){var c=e.call(this,r)||this;return c.code=n,c.statusCode=o,c.request=i,c.response=a,c.body=s,Object.setPrototypeOf(c,t.prototype),c}return r(t,e),t.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",t.REQUEST_ABORTED_ERROR="REQUEST_ABORTED_ERROR",t.PARSE_ERROR="PARSE_ERROR",t}(Error),le=function(){function e(){}return e.prototype.sendRequest=function(e){var t=new XMLHttpRequest;if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var r=e.abortSignal;if(r){var n=function(){t.abort()};r.addEventListener("abort",n),t.addEventListener("readystatechange",function(){t.readyState===XMLHttpRequest.DONE&&r.removeEventListener("abort",n)})}if(de(t.upload,e.onUploadProgress),de(t,e.onDownloadProgress),e.formData){for(var o=e.formData,i=new FormData,a=function(e,t){t&&t.hasOwnProperty("value")&&t.hasOwnProperty("options")?i.append(e,t.value,t.options):i.append(e,t)},s=0,c=Object.keys(o);s<c.length;s++){var u=c[s],l=o[u];if(Array.isArray(l))for(var d=0;d<l.length;d++)a(u,l[d]);else a(u,l)}e.body=i,e.formData=void 0;var p=e.headers.get("Content-Type");p&&-1!==p.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}t.open(e.method,e.url),t.timeout=e.timeout,t.withCredentials=e.withCredentials;for(var h=0,f=e.headers.headersArray();h<f.length;h++){var m=f[h];t.setRequestHeader(m.name,m.value)}return t.responseType=e.streamResponseBody?"blob":"text",t.send(void 0===e.body?null:e.body),e.streamResponseBody?new Promise(function(r,n){t.addEventListener("readystatechange",function(){if(t.readyState===XMLHttpRequest.HEADERS_RECEIVED){var n=new Promise(function(r,n){t.addEventListener("load",function(){r(t.response)}),he(e,t,n)});r({request:e,status:t.status,headers:pe(t),blobBody:n})}}),he(e,t,n)}):new Promise(function(r,n){t.addEventListener("load",function(){return r({request:e,status:t.status,headers:pe(t),bodyAsText:t.responseText})}),he(e,t,n)})},e}();function de(e,t){t&&e.addEventListener("progress",function(e){return t({loadedBytes:e.loaded})})}function pe(e){for(var t=new L,r=0,n=e.getAllResponseHeaders().trim().split(/[\r\n]+/);r<n.length;r++){var o=n[r],i=o.indexOf(":"),a=o.slice(0,i),s=o.slice(i+2);t.set(a,s)}return t}function he(e,t,r){t.addEventListener("error",function(){return r(new ue("Failed to send request to "+e.url,ue.REQUEST_SEND_ERROR,void 0,e))}),t.addEventListener("abort",function(){return r(new ue("The request was aborted",ue.REQUEST_ABORTED_ERROR,void 0,e))}),t.addEventListener("timeout",function(){return r(new ue("timeout of "+t.timeout+"ms exceeded",ue.REQUEST_SEND_ERROR,void 0,e))})}function fe(e){return me(e.parameterPath,e.mapper)}function me(e,t){return"string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName}function ye(e){var t=!1;for(var r in e.responses){var n=e.responses[r];if(n.bodyMapper&&n.bodyMapper.type.name===se.Stream){t=!0;break}}return t}!function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO"}(ae||(ae={}));var ge=new DOMParser;function ve(e){try{var t=ge.parseFromString(e,"application/xml");!function(e){if(we){var t=e.getElementsByTagNameNS(we,"parsererror");if(t.length)throw new Error(t.item(0).innerHTML)}}(t);var r=function e(t){var r={};var n=t.childNodes.length;var o=t.childNodes[0];var i=o&&1===n&&o.nodeType===Node.TEXT_NODE&&o.nodeValue||void 0;var a=function(e){return function(e){return!!e.attributes}(e)&&e.hasAttributes()?e:void 0}(t);if(a){r.$={};for(var s=0;s<a.attributes.length;s++){var c=a.attributes[s];r.$[c.nodeName]=c.nodeValue}i&&(r._=i)}else 0===n?r="":i&&(r=i);if(!i)for(var s=0;s<n;s++){var u=t.childNodes[s];if(u.nodeType!==Node.TEXT_NODE){var l=e(u);r[u.nodeName]?Array.isArray(r[u.nodeName])?r[u.nodeName].push(l):r[u.nodeName]=[r[u.nodeName],l]:r[u.nodeName]=l}}return r}(t.childNodes[0]);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}var we="";try{we=ge.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){}var be=document.implementation.createDocument(null,null,null),Te=new XMLSerializer;function Ee(e,t){var r=function e(t,r){if("string"==typeof t||"number"==typeof t||"boolean"==typeof t){var n=be.createElement(r);return n.textContent=t.toString(),[n]}if(Array.isArray(t)){for(var o=[],i=0,a=t;i<a.length;i++)for(var s=a[i],c=0,u=e(s,r);c<u.length;c++){var l=u[c];o.push(l)}return o}if("object"==typeof t){for(var n=be.createElement(r),d=0,p=Object.keys(t);d<p.length;d++){var h=p[d];if("$"===h)for(var f=0,m=Se(t[h]);f<m.length;f++){var y=m[f];n.attributes.setNamedItem(y)}else for(var g=0,v=e(t[h],h);g<v.length;g++){var l=v[g];n.appendChild(l)}}return[n]}throw new Error("Illegal value passed to buildObject: "+t)}(e,t&&t.rootName||"root")[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+Te.serializeToString(r)}function Se(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],i=be.createAttribute(o);i.value=e[o].toString(),t.push(i)}return t}var Ie=function(){function e(e,t){this._nextPolicy=e,this._options=t}return e.prototype.shouldLog=function(e){return this._options.shouldLog(e)},e.prototype.log=function(e,t){this._options.log(e,t)},e}(),ke=function(){function e(e){this._logger=e}return e.prototype.shouldLog=function(e){return!!this._logger&&e!==ae.OFF&&e<=this._logger.minimumLogLevel},e.prototype.log=function(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)},e}();var Ce=["application/json","text/json","text/plain"],Pe=["application/xml","application/atom+xml"],Re=function(e){function t(t,r,n){var o=e.call(this,t,n)||this;return o.jsonContentTypes=r&&r.json||Ce,o.xmlContentTypes=r&&r.xml||Pe,o}return r(t,e),t.prototype.sendRequest=function(e){return o(this,void 0,void 0,function(){var t=this;return i(this,function(r){return[2,this._nextPolicy.sendRequest(e).then(function(e){return function(e,t,r){return function(e,t,r){var n=function(e){var t='Error "'+e+'" occurred while parsing the response body - '+r.bodyAsText+".",n=e.code||ue.PARSE_ERROR,o=new ue(t,n,r.status,r.request,r,r.bodyAsText);return Promise.reject(o)};if(!r.request.streamResponseBody&&r.bodyAsText){var o=r.bodyAsText,i=r.headers.get("Content-Type")||"",a=i?i.split(";").map(function(e){return e.toLowerCase()}):[];if(0===a.length||a.some(function(t){return-1!==e.indexOf(t)}))return new Promise(function(e){r.parsedBody=JSON.parse(o),e(r)}).catch(n);if(a.some(function(e){return-1!==t.indexOf(e)}))return ve(o).then(function(e){return r.parsedBody=e,r}).catch(n)}return Promise.resolve(r)}(e,t,r).then(function(e){if(function(e){var t,r=e.request.shouldDeserialize;t=void 0===r||("boolean"==typeof r?r:r(e));return t}(e)){var t=e.request.operationSpec;if(t&&t.responses){var n=e.status,o=Object.keys(t.responses),i=0===o.length||1===o.length&&"default"===o[0],a=function(e){var t,r=e.request,n=r.operationSpec;if(n){var o=r.operationResponseGetter;t=o?o(n,e):n.responses[e.status]}return t}(e);if(i?200<=n&&n<300:!!a){if(a){if(a.bodyMapper){f=e.parsedBody;t.isXML&&a.bodyMapper.type.name===se.Sequence&&(f="object"==typeof f?f[a.bodyMapper.xmlElementName]:[]);try{e.parsedBody=t.serializer.deserialize(a.bodyMapper,f,"operationRes.parsedBody")}catch(l){var s=new ue("Error "+l+" occurred in deserializing the responseBody - "+e.bodyAsText);return s.request=G(e.request),s.response=$(e),Promise.reject(s)}}else"HEAD"===t.httpMethod&&(e.parsedBody=r.status>=200&&r.status<300);a.headersMapper&&(e.parsedHeaders=t.serializer.deserialize(a.headersMapper,e.headers.rawHeaders(),"operationRes.parsedHeaders"))}}else{var c=t.responses.default;if(c){var u=ye(t)?"Unexpected status code: "+n:e.bodyAsText,l=new ue(u);l.statusCode=n,l.request=G(e.request),l.response=$(e);var d=e.parsedBody;try{if(d){var p=c.bodyMapper;if(p&&"CloudError"===p.serializedName)d.error&&(d=d.error),d.code&&(l.code=d.code),d.message&&(l.message=d.message);else{var h=d;d.error&&(h=d.error),l.code=h.code,h.message&&(l.message=h.message)}if(p){var f=d;t.isXML&&p.type.name===se.Sequence&&(f="object"==typeof d?d[p.xmlElementName]:[]),l.body=t.serializer.deserialize(p,f,"error.body")}}}catch(t){l.message='Error "'+t.message+'" occurred in deserializing the responseBody - "'+e.bodyAsText+'" for the default response.'}return Promise.reject(l)}}}}return Promise.resolve(e)})}(t.jsonContentTypes,t.xmlContentTypes,e)})]})})},t}(Ie);var _e=3e4,Ae=3,Oe=9e4,xe=3e3,qe=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r)||this;function c(e){return"number"==typeof e}return s.retryCount=c(n)?n:Ae,s.retryInterval=c(o)?o:_e,s.minRetryInterval=c(i)?i:xe,s.maxRetryInterval=c(a)?a:Oe,s}return r(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then(function(r){return Ne(t,e,r)}).catch(function(r){return Ne(t,e,r.response,void 0,r)})},t}(Ie);function Ne(e,t,r,n,o){n=function(e,t,r){t||(t={retryCount:0,retryInterval:0}),r&&(t.error&&(r.innerError=t.error),t.error=r),t.retryCount++;var n=Math.pow(2,t.retryCount)-1;return n*=.8*e.retryInterval+Math.floor(Math.random()*(1.2*e.retryInterval-.8*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+n,e.maxRetryInterval),t}(e,n,o);var i=t.abortSignal&&t.abortSignal.aborted;if(!i&&function(e,t,r){if(null==t||t<500&&408!==t||501===t||505===t)return!1;if(!r)throw new Error("retryData for the ExponentialRetryPolicyFilter cannot be null.");return(r&&r.retryCount)<e.retryCount}(e,r&&r.status,n))return K(n.retryInterval).then(function(){return e._nextPolicy.sendRequest(t.clone())}).then(function(r){return Ne(e,t,r,n,void 0)}).catch(function(o){return Ne(e,t,r,n,o)});if(i||o||!r){var a=n.error||new ue("Failed to send the request.",ue.REQUEST_SEND_ERROR,r&&r.status,r&&r.request,r);return Promise.reject(a)}return Promise.resolve(r)}var Ue=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._requestIdHeaderName=n,o}return r(t,e),t.prototype.sendRequest=function(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,J()),this._nextPolicy.sendRequest(e)},t}(Ie);function je(){return"x-ms-command-name"}var De=je;function Le(){var e,t,r,n,o=[{key:"core-http",value:W.coreHttpVersion}],i=[{key:"OS",value:((e=window.navigator).oscpu||e.platform).replace(" ","")}];return t=o.concat(i),void 0===r&&(r=" "),void 0===n&&(n="/"),t.map(function(e){var t=e.value?""+n+e.value:"";return""+e.key+t}).join(r)}var Me=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return i._nextPolicy=t,i._options=r,i.headerKey=n,i.headerValue=o,i}return r(t,e),t.prototype.sendRequest=function(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)},t.prototype.addUserAgentHeader=function(e){e.headers||(e.headers=new L),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)},t}(Ie),He=function(){function e(){this._rawQuery={}}return e.prototype.any=function(){return Object.keys(this._rawQuery).length>0},e.prototype.set=function(e,t){if(e)if(null!=t){var r=Array.isArray(t)?t:t.toString();this._rawQuery[e]=r}else delete this._rawQuery[e]},e.prototype.get=function(e){return e?this._rawQuery[e]:void 0},e.prototype.toString=function(){var e="";for(var t in this._rawQuery){e&&(e+="&");var r=this._rawQuery[t];if(Array.isArray(r)){for(var n=[],o=0,i=r;o<i.length;o++){var a=i[o];n.push(t+"="+a)}e+=n.join("&")}else e+=t+"="+r}return e},e.parse=function(t){var r=new e;if(t){t.startsWith("?")&&(t=t.substring(1));for(var n="ParameterName",o="",i="",a=0;a<t.length;++a){var s=t[a];switch(n){case"ParameterName":switch(s){case"=":n="ParameterValue";break;case"&":o="",i="";break;default:o+=s}break;case"ParameterValue":switch(s){case"=":o="",i="",n="Invalid";break;case"&":r.set(o,i),o="",i="",n="ParameterName";break;default:i+=s}break;case"Invalid":"&"===s&&(n="ParameterName");break;default:throw new Error("Unrecognized URLQuery parse state: "+n)}}"ParameterValue"===n&&r.set(o,i)}return r},e}(),ze=function(){function e(){}return e.prototype.setScheme=function(e){e?this.set(e,"SCHEME"):this._scheme=void 0},e.prototype.getScheme=function(){return this._scheme},e.prototype.setHost=function(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0},e.prototype.getHost=function(){return this._host},e.prototype.setPort=function(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")},e.prototype.getPort=function(){return this._port},e.prototype.setPath=function(e){e?-1!==e.indexOf("://")?this.set(e,"SCHEME"):this.set(e,"PATH"):this._path=void 0},e.prototype.appendPath=function(e){if(e){var t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}},e.prototype.getPath=function(){return this._path},e.prototype.setQuery=function(e){this._query=e?He.parse(e):void 0},e.prototype.setQueryParameter=function(e,t){e&&(this._query||(this._query=new He),this._query.set(e,t))},e.prototype.getQueryParameterValue=function(e){return this._query?this._query.get(e):void 0},e.prototype.getQuery=function(){return this._query?this._query.toString():void 0},e.prototype.set=function(e,t){for(var r=new Be(e,t);r.next();){var n=r.current();if(n)switch(n.type){case"SCHEME":this._scheme=n.text||void 0;break;case"HOST":this._host=n.text||void 0;break;case"PORT":this._port=n.text||void 0;break;case"PATH":var o=n.text||void 0;this._path&&"/"!==this._path&&"/"===o||(this._path=o);break;case"QUERY":this._query=He.parse(n.text);break;default:throw new Error("Unrecognized URLTokenType: "+n.type)}}},e.prototype.toString=function(){var e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e},e.prototype.replaceAll=function(e,t){e&&(this.setScheme(Y(this.getScheme(),e,t)),this.setHost(Y(this.getHost(),e,t)),this.setPort(Y(this.getPort(),e,t)),this.setPath(Y(this.getPath(),e,t)),this.setQuery(Y(this.getQuery(),e,t)))},e.parse=function(t){var r=new e;return r.set(t,"SCHEME_OR_HOST"),r},e}(),Fe=function(){function e(e,t){this.text=e,this.type=t}return e.scheme=function(t){return new e(t,"SCHEME")},e.host=function(t){return new e(t,"HOST")},e.port=function(t){return new e(t,"PORT")},e.path=function(t){return new e(t,"PATH")},e.query=function(t){return new e(t,"QUERY")},e}();var Be=function(){function e(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=null!=t?t:"SCHEME_OR_HOST",this._currentIndex=0}return e.prototype.current=function(){return this._currentToken},e.prototype.next=function(){if(Ve(this))switch(this._currentState){case"SCHEME":t=function(e){return Ge(e,function(e){return function(e){var t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e)})}(e=this),e._currentToken=Fe.scheme(t),Ve(e)?e._currentState="HOST":e._currentState="DONE";break;case"SCHEME_OR_HOST":!function(e){var t=Je(e,":","/","?");Ve(e)?":"===Qe(e)?"://"===$e(e,3)?(e._currentToken=Fe.scheme(t),e._currentState="HOST"):(e._currentToken=Fe.host(t),e._currentState="PORT"):(e._currentToken=Fe.host(t),"/"===Qe(e)?e._currentState="PATH":e._currentState="QUERY"):(e._currentToken=Fe.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===$e(e,3)&&We(e,3);var t=Je(e,":","/","?");e._currentToken=Fe.host(t),Ve(e)?":"===Qe(e)?e._currentState="PORT":"/"===Qe(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PORT":!function(e){":"===Qe(e)&&We(e);var t=Je(e,"/","?");e._currentToken=Fe.port(t),Ve(e)?"/"===Qe(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PATH":!function(e){var t=Je(e,"?");e._currentToken=Fe.path(t),Ve(e)?e._currentState="QUERY":e._currentState="DONE"}(this);break;case"QUERY":!function(e){"?"===Qe(e)&&We(e);var t=function(e){var t="";e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength);return t}(e);e._currentToken=Fe.query(t),e._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;var e,t;return!!this._currentToken},e}();function Ve(e){return e._currentIndex<e._textLength}function Qe(e){return e._text[e._currentIndex]}function We(e,t){Ve(e)&&(t||(t=1),e._currentIndex+=t)}function $e(e,t){var r=e._currentIndex+t;return e._textLength<r&&(r=e._textLength),e._text.substring(e._currentIndex,r)}function Ge(e,t){for(var r="";Ve(e);){var n=Qe(e);if(!t(n))break;r+=n,We(e)}return r}function Je(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return Ge(e,function(e){return-1===t.indexOf(e)})}var Ke=function(e){function t(t,r,n){void 0===n&&(n=20);var o=e.call(this,t,r)||this;return o.maxRetries=n,o}return r(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e).then(function(e){return function e(t,r,n){var o=r.request,i=r.status;var a=r.headers.get("location");if(a&&(300===i||307===i||303===i&&"POST"===o.method)&&(!t.maxRetries||n<t.maxRetries)){var s=ze.parse(o.url);return s.setPath(a),o.url=s.toString(),303===i&&(o.method="GET"),t._nextPolicy.sendRequest(o).then(function(r){return e(t,r,n+1)})}return Promise.resolve(r)}(t,e,0)})},t}(Ie);var Xe=function(e){function t(t,r,n){void 0===n&&(n=30);var o=e.call(this,t,r)||this;return o._retryTimeout=n,o}return r(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then(function(r){return function(e,t,r){if(409===r.status){var n=function(e){var t,r;if(e){try{r=JSON.parse(e)}catch(e){}if(r&&r.error&&r.error.message&&r.error.code&&"MissingSubscriptionRegistration"===r.error.code){var n=r.error.message.match(/.*'(.*)'/i);n&&(t=n.pop())}}return t}(r.bodyAsText);if(n){var o=function(e){var t,r=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!r||!r[0])throw new Error("Unable to extract subscriptionId from the given url - "+e+".");t=r[0];return t}(t.url);return function(e,t,r,n){var o=t+"providers/"+r+"/register?api-version=2016-02-01",i=t+"providers/"+r+"?api-version=2016-02-01",a=Ye(n);return a.method="POST",a.url=o,e._nextPolicy.sendRequest(a).then(function(t){if(200!==t.status)throw new Error("Autoregistration of "+r+" failed. Please try registering manually.");return function e(t,r,n){var o=Ye(n);o.url=r;o.method="GET";return t._nextPolicy.sendRequest(o).then(function(o){var i=o.parsedBody;return!(!o.parsedBody||!i.registrationState||"Registered"!==i.registrationState)||K(1e3*t._retryTimeout).then(function(){return e(t,r,n)})})}(e,i,n)})}(e,o,n,t).catch(function(){return!1}).then(function(n){return n?(t.headers.set("x-ms-client-request-id",J()),e._nextPolicy.sendRequest(t.clone())):r})}}return Promise.resolve(r)}(t,e,r)})},t}(Ie);function Ye(e,t){void 0===t&&(t=!1);var r=e.clone();return t&&(r.url=e.url),r.headers.set("x-ms-client-request-id",J()),r.headers.set("Content-Type","application/json; charset=utf-8"),r}var Ze=12e4,et=function(){function e(e){void 0===e&&(e=Ze),this.cachedToken=void 0,this.tokenRefreshBufferMs=e}return e.prototype.setCachedToken=function(e){this.cachedToken=e},e.prototype.getCachedToken=function(){return this.cachedToken&&Date.now()+this.tokenRefreshBufferMs>=this.cachedToken.expiresOnTimestamp&&(this.cachedToken=void 0),this.cachedToken},e}();var tt=function(e){function t(t,r,n,o,i){var a=e.call(this,t,r)||this;return a.credential=n,a.scopes=o,a.tokenCache=i,a}return r(t,e),t.prototype.sendRequest=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return e.headers||(e.headers=new L),[4,this.getToken({abortSignal:e.abortSignal})];case 1:return t=r.sent(),e.headers.set(W.HeaderConstants.AUTHORIZATION,"Bearer "+t),[2,this._nextPolicy.sendRequest(e)]}})})},t.prototype.getToken=function(e){return o(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return void 0!==(t=this.tokenCache.getCachedToken())?[3,2]:[4,this.credential.getToken(this.scopes,e)];case 1:t=r.sent()||void 0,this.tokenCache.setCachedToken(t),r.label=2;case 2:return[2,t?t.token:void 0]}})})},t}(Ie);var rt,nt=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r)||this;return s.DEFAULT_CLIENT_RETRY_INTERVAL=3e4,s.DEFAULT_CLIENT_RETRY_COUNT=3,s.DEFAULT_CLIENT_MAX_RETRY_INTERVAL=9e4,s.DEFAULT_CLIENT_MIN_RETRY_INTERVAL=3e3,s.retryCount="number"==typeof n?n:s.DEFAULT_CLIENT_RETRY_COUNT,s.retryInterval="number"==typeof o?o:s.DEFAULT_CLIENT_RETRY_INTERVAL,s.minRetryInterval="number"==typeof i?i:s.DEFAULT_CLIENT_MIN_RETRY_INTERVAL,s.maxRetryInterval="number"==typeof a?a:s.DEFAULT_CLIENT_MAX_RETRY_INTERVAL,s}return r(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then(function(r){return function e(t,r,n,o,i){o=function(e,t,r){t||(t={retryCount:0,retryInterval:0});r&&(t.error&&(r.innerError=t.error),t.error=r);t.retryCount++;var n=Math.pow(2,t.retryCount)-1,o=.8*e.retryInterval+Math.floor(Math.random()*(1.2*e.retryInterval-.8*e.retryInterval));return n*=o,t.retryInterval=Math.min(e.minRetryInterval+n,e.maxRetryInterval),t}(t,o,i);return i&&i.code&&function(e,t){var r;if(!t)throw new Error("retryData for the SystemErrorRetryPolicyFilter cannot be null.");r=t&&t.retryCount;return r<e.retryCount}(t,o)&&("ETIMEDOUT"===i.code||"ESOCKETTIMEDOUT"===i.code||"ECONNREFUSED"===i.code||"ECONNRESET"===i.code||"ENOENT"===i.code)?K(o.retryInterval).then(function(){return t._nextPolicy.sendRequest(r.clone())}).then(function(n){return e(t,r,n,o,i)}).catch(function(i){return e(t,r,n,o,i)}):null!=i?(i=o.error,Promise.reject(i)):Promise.resolve(n)}(t,e,r)})},t}(Ie);!function(e){e.Csv=",",e.Ssv=" ",e.Tsv="\t",e.Pipes="|",e.Multi="Multi"}(rt||(rt={}));var ot=new Error("ProxyPolicy is not supported in browser environment");!function(e){function t(t,r){e.call(this,t,r);throw ot}r(t,e),t.prototype.sendRequest=function(e){throw ot}}(Ie);var it=W.HttpConstants.StatusCodes;var at=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._handleResponse=n||o._defaultResponseHandler,o}return r(t,e),t.prototype.sendRequest=function(e){return o(this,void 0,void 0,function(){var t=this;return i(this,function(r){return[2,this._nextPolicy.sendRequest(e.clone()).then(function(r){return r.status!==it.TooManyRequests?r:t._handleResponse(e,r)})]})})},t.prototype._defaultResponseHandler=function(e,r){return o(this,void 0,void 0,function(){var n,o,a=this;return i(this,function(i){return(n=r.headers.get(W.HeaderConstants.RETRY_AFTER))&&(o=t.parseRetryAfterHeader(n))?[2,K(o).then(function(t){return a._nextPolicy.sendRequest(e)})]:[2,r]})})},t.parseRetryAfterHeader=function(e){var r=Number(e);return Number.isNaN(r)?t.parseDateRetryAfterHeader(e):1e3*r},t.parseDateRetryAfterHeader=function(e){try{var t=Date.now(),r=Date.parse(e)-t;return Number.isNaN(r)?void 0:r}catch(e){return}},t}(Ie);var st=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.authenticationProvider=n,o}return r(t,e),t.prototype.signRequest=function(e){return this.authenticationProvider.signRequest(e)},t.prototype.sendRequest=function(e){var t=this;return this.signRequest(e).then(function(e){return t._nextPolicy.sendRequest(e)})},t}(Ie),ct=function(){function e(e,t){var r,n,o,i,a,s=this;if(t||(t={}),this._withCredentials=t.withCredentials||!1,this._httpClient=t.httpClient||new le,this._requestPolicyOptions=new ke(t.httpPipelineLogger),Array.isArray(t.requestPolicyFactories))r=t.requestPolicyFactories;else{var c=void 0;if((a=e)&&"function"==typeof a.getToken&&(void 0===a.signRequest||a.getToken.length>0)){o=void 0,i=s,c={create:function(t,r){return void 0===o&&(o=function(e,t){var r=new et;return{create:function(n,o){return new tt(n,o,e,t,r)}}}(e,(i.baseUri||"")+"/.default")),o.create(t,r)}}}else if(e&&"function"==typeof e.signRequest)n=e,c={create:function(e,t){return new st(e,t,n)}};else if(void 0!==e)throw new Error("The credentials argument must implement the TokenCredential interface");if(r=function(e,t){var r=[];t.generateClientRequestIdHeader&&r.push((void 0===(n=t.clientRequestIdHeaderName)&&(n="x-ms-client-request-id"),{create:function(e,t){return new Ue(e,t,n)}}));var n;e&&r.push(e);var o=ut(t.userAgentHeaderName,De),i=ut(t.userAgent,Le);o&&i&&r.push((s=(a={key:o,value:i})&&null!=a.key?a.key:"x-ms-command-name",c=a&&null!=a.value?a.value:Le(),{create:function(e,t){return new Me(e,t,s,c)}}));var a,s,c;r.push(function(e){return void 0===e&&(e=20),{create:function(t,r){return new Ke(t,r,e)}}}()),r.push(function(e){return void 0===e&&(e=30),{create:function(t,r){return new Xe(t,r,e)}}}(t.rpRegistrationRetryTimeout)),t.noRetryPolicy||(r.push({create:function(e,t){return new qe(e,t,u,l,d,p)}}),r.push(function(e,t,r,n){return{create:function(o,i){return new nt(o,i,e,t,r,n)}}}()),r.push({create:function(e,t){return new at(e,t)}}));var u,l,d,p;r.push(function(e){return{create:function(t,r){return new Re(t,e,r)}}}(t.deserializationContentTypes)),t.proxySettings?r.push({create:function(e,t){throw ot}}):void 0;return r}(c,t),t.requestPolicyFactories){var u=t.requestPolicyFactories(r);u&&(r=u)}}this._requestPolicyFactories=r}return e.prototype.sendRequest=function(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");var t;try{e instanceof ce?(e.validateRequestProperties(),t=e):t=(t=new ce).prepare(e)}catch(e){return Promise.reject(e)}var r=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var n=this._requestPolicyFactories.length-1;n>=0;--n)r=this._requestPolicyFactories[n].create(r,this._requestPolicyOptions);return r.sendRequest(t)},e.prototype.sendOperationRequest=function(e,t,r){"function"==typeof e.options&&(r=e.options,e.options=void 0);var o,i=new ce;try{var a=t.baseUrl||this.baseUri;if(!a)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");i.method=t.httpMethod,i.operationSpec=t;var s=ze.parse(a);if(t.path&&s.appendPath(t.path),t.urlParameters&&t.urlParameters.length>0)for(var c=0,u=t.urlParameters;c<u.length;c++){var l=u[c],d=lt(this,e,l,t.serializer);d=t.serializer.serialize(l.mapper,d,fe(l)),l.skipEncoding||(d=encodeURIComponent(d)),s.replaceAll("{"+(l.mapper.serializedName||fe(l))+"}",d)}if(t.queryParameters&&t.queryParameters.length>0)for(var p=0,h=t.queryParameters;p<h.length;p++){var f=h[p],m=lt(this,e,f,t.serializer);if(null!=m){if(m=t.serializer.serialize(f.mapper,m,fe(f)),null!=f.collectionFormat)if(f.collectionFormat===rt.Multi)if(0===m.length)m="";else for(var y in m){var g=m[y];m[y]=null==g?"":g.toString()}else m=m.join(f.collectionFormat);if(!f.skipEncoding)if(Array.isArray(m))for(var y in m)m[y]=encodeURIComponent(m[y]);else m=encodeURIComponent(m);s.setQueryParameter(f.mapper.serializedName||fe(f),m)}}i.url=s.toString();var v=t.contentType||this.requestContentType;if(v&&i.headers.set("Content-Type",v),t.headerParameters)for(var w=0,b=t.headerParameters;w<b.length;w++){var T=b[w],E=lt(this,e,T,t.serializer);if(null!=E){E=t.serializer.serialize(T.mapper,E,fe(T));var S=T.mapper.headerCollectionPrefix;if(S)for(var I=0,k=Object.keys(E);I<k.length;I++){var C=k[I];i.headers.set(S+C,E[C])}else i.headers.set(T.mapper.serializedName||fe(T),E)}}var P=e.options;if(P){if(P.customHeaders)for(var R in P.customHeaders)i.headers.set(R,P.customHeaders[R]);P.abortSignal&&(i.abortSignal=P.abortSignal),P.timeout&&(i.timeout=P.timeout),P.onUploadProgress&&(i.onUploadProgress=P.onUploadProgress),P.onDownloadProgress&&(i.onDownloadProgress=P.onDownloadProgress),P.spanOptions&&(i.spanOptions=P.spanOptions)}i.withCredentials=this._withCredentials,function(e,t,r,n){if(n.requestBody&&n.requestBody.mapper){t.body=lt(e,r,n.requestBody,n.serializer);var o=n.requestBody.mapper,i=o.required,a=o.xmlName,s=o.xmlElementName,c=o.serializedName,u=o.type.name;try{if(null!=t.body||i){var l=fe(n.requestBody);t.body=n.serializer.serialize(o,t.body,l);var d=u===se.Stream;n.isXML?u===se.Sequence?t.body=Ee(function(e,t){var r;return Array.isArray(e)||(e=[e]),(r={})[t]=e,r}(t.body,s||a||c),{rootName:a||c}):d||(t.body=Ee(t.body,{rootName:a||c})):d||(t.body=JSON.stringify(t.body))}}catch(e){throw new Error('Error "'+e.message+'" occurred in serializing the payload - '+JSON.stringify(c,void 0,"  ")+".")}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(var p=0,h=n.formDataParameters;p<h.length;p++){var f=h[p],m=lt(e,r,f,n.serializer);if(null!=m){var y=f.mapper.serializedName||fe(f);t.formData[y]=n.serializer.serialize(f.mapper,m,fe(f))}}}}(this,i,e,t),null==i.streamResponseBody&&(i.streamResponseBody=ye(t)),o=this.sendRequest(i).then(function(e){return function(e,t){var r=e.parsedHeaders,o=t&&t.bodyMapper,i=function(t){return Object.defineProperty(t,"_response",{value:e})};if(o){var a=o.type.name;if("Stream"===a)return i(n({},r,{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));var s="Composite"===a&&o.type.modelProperties||{},c=Object.keys(s).some(function(e){return""===s[e].serializedName});if("Sequence"===a||c){for(var u=(e.parsedBody||[]).slice(),l=0,d=Object.keys(s);l<d.length;l++){var p=d[l];s[p].serializedName&&(u[p]=e.parsedBody[p])}if(r)for(var h=0,f=Object.keys(r);h<f.length;h++){p=f[h];u[p]=r[p]}return i(u),u}if("Composite"===a||"Dictionary"===a)return i(n({},r,e.parsedBody))}if(o||"HEAD"===e.request.method||(m=e.parsedBody,"object"!=typeof m&&"function"!=typeof m||null===m))return i(n({},r,{body:e.parsedBody}));var m;return i(n({},r,e.parsedBody))}(e,t.responses[e.status])})}catch(e){o=Promise.reject(e)}var _=r;return _&&o.then(function(e){return _(null,e._response.parsedBody,e._response.request,e._response)}).catch(function(e){return _(e)}),o},e}();function ut(e,t){var r;return"string"==typeof e?r=e:(r=t(),"function"==typeof e&&(r=e(r))),r}function lt(e,t,r,n){return function e(t,r,n,o,i){var a;"string"==typeof n&&(n=[n]);if(Array.isArray(n)){if(n.length>0){if(o.isConstant)a=o.defaultValue;else{var s=dt(r,n);s.propertyFound||(s=dt(t,n));var c=!1;s.propertyFound||(c=o.required||"options"===n[0]&&2===n.length),a=c?o.defaultValue:s.propertyValue}var u=me(n,o);i.serialize(o,a,u)}}else for(var l in o.required&&(a={}),n){var d=o.type.modelProperties[l],p=n[l],h=e(t,r,p,d,i),f=me(p,d);i.serialize(d,h,f),void 0!==h&&(a||(a={}),a[l]=h)}return a}(e,t,r.parameterPath,r.mapper,n)}function dt(e,t){for(var r={propertyFound:!1},n=0;n<t.length;++n){var o=t[n];if(!(null!=e&&o in e))break;e=e[o]}return n===t.length&&(r.propertyValue=e,r.propertyFound=!0),r}const pt="https://login.microsoftonline.com";class ht extends ct{constructor(e){if(super(void 0,e=e||ht.getDefaultOptions()),this.baseUri=this.authorityHost=e.authorityHost||pt,!this.baseUri.startsWith("https:"))throw new Error("The authorityHost address must use the 'https' protocol.")}createWebResource(e){const t=new ce;return t.prepare(e),t}sendTokenRequest(e,t){return o(this,void 0,void 0,function*(){const r=yield this.sendRequest(e);if(t=t||(e=>Date.now()+1e3*e.expires_in),200===r.status||201===r.status)return{accessToken:{token:r.parsedBody.access_token,expiresOnTimestamp:t(r.parsedBody)},refreshToken:r.parsedBody.refresh_token};throw new a(r.status,r.parsedBody||r.bodyAsText)})}refreshAccessToken(e,t,r,n,i,s,c){return o(this,void 0,void 0,function*(){if(void 0===n)return null;const o={grant_type:"refresh_token",client_id:t,refresh_token:n,scope:r};void 0!==i&&(o.client_secret=i);const u=this.createWebResource({url:`${this.authorityHost}/${e}/oauth2/v2.0/token`,method:"POST",disableJsonStringifyOnBody:!0,deserializationMapper:void 0,body:j.stringify(o),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},abortSignal:c&&c.abortSignal});try{return yield this.sendTokenRequest(u,s)}catch(e){if(e instanceof a&&"interaction_required"===e.errorResponse.error)return null;throw e}})}static getDefaultOptions(){return{authorityHost:pt}}}const ft=new Error("ClientCertificateCredential is not supported in the browser.");var mt=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?a+=o[i]:"y"===n[s]?(i&=3,a+=o[i|=8]):a+=n[s];return a},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},e.base64Decode=function(e){return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}(),yt=function(){function e(){}return Object.defineProperty(e,"errorDescription",{get:function(){return"error_description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"error",{get:function(){return"error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scope",{get:function(){return"scope"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientInfo",{get:function(){return"client_info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idToken",{get:function(){return"id_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessToken",{get:function(){return"access_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expiresIn",{get:function(){return"expires_in"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sessionState",{get:function(){return"session_state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalClientInfo",{get:function(){return"msal.client.info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalError",{get:function(){return"msal.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalErrorDescription",{get:function(){return"msal.error.description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalSessionState",{get:function(){return"msal.session.state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenKeys",{get:function(){return"msal.token.keys"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessTokenKey",{get:function(){return"msal.access.token.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expirationKey",{get:function(){return"msal.expiration.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateLogin",{get:function(){return"msal.state.login"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateAcquireToken",{get:function(){return"msal.state.acquireToken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateRenew",{get:function(){return"msal.state.renew"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"nonceIdToken",{get:function(){return"msal.nonce.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userName",{get:function(){return"msal.username"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idTokenKey",{get:function(){return"msal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginRequest",{get:function(){return"msal.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginError",{get:function(){return"msal.login.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewStatus",{get:function(){return"msal.token.renew.status"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"urlHash",{get:function(){return"msal.urlHash"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"angularLoginRequest",{get:function(){return"msal.angular.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msal",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"consumersUtid",{get:function(){return"9188040d-6c67-4c5b-b112-36a304b66dad"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCancelled",{get:function(){return"Canceled"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCompleted",{get:function(){return"Completed"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusInProgress",{get:function(){return"In Progress"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheLocationLocal",{get:function(){return"localStorage"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheLocationSession",{get:function(){return"sessionStorage"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}(),gt="msal.authority",vt="msal.acquireTokenAccount",wt={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},bt="sid",Tt="login_hint",Et="id_token",St="domain_hint",It="organizations",kt="consumers",Ct="homeAccountIdentifier",Pt="login_req",Rt="domain_req",_t=[bt,Tt],At={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};var Ot=function(){function e(){}return e.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var r=0;r<t.length;r++)if(e.indexOf(t[r].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){return e=this.convertToLowerCase(e),t.every(function(t){return e.indexOf(t.toString().toLowerCase())>=0})},e.convertToLowerCase=function(e){return e.map(function(e){return e.toLowerCase()})},e.removeElement=function(e,t){return e.filter(function(e){return e!==t})},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e}(),xt=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e}(),qt=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var r=[];return r.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),r.push("scope="+encodeURIComponent(Ot.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.translateclientIdUsedInScope=function(e,t){var r=e.indexOf(t);r>=0&&(e.splice(r,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.getDefaultRedirectUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),n=r.PathSegments;return!t||0===n.length||n[0]!==yt.common&&n[0]!==It||(n[0]=t),this.constructAuthorityUriFromObject(r,n)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0}),n.PathSegments=o,n},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(xt.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e}(),Nt=function(e,t,r,n,o){this.authority=qt.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=mt.base64Encode(n)+"."+mt.base64Encode(o)},Ut=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n},jt={code:"unexpected_error",desc:"Unexpected error in authentication."},Dt=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o}return r(t,e),t.createUnexpectedError=function(e){return new t(jt.code,jt.desc+": "+e)},t}(Error),Lt={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},Mt={code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},Ht={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},zt={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},Ft={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},Bt={code:"invalid_id_token",desc:"Invalid ID token format."},Vt={code:"invalid_state_error",desc:"Invalid state."},Qt={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},Wt={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},$t={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},Gt={code:"user_cancelled",desc:"User cancelled the flow."},Jt={code:"callback_error",desc:"Error occurred in token received callback function."},Kt={code:"user_login_error",desc:"User login is required."},Xt={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},Yt={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},Zt={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},er={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},tr={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},rr={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},nr={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},or=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return r(t,e),t.createEndpointResolutionError=function(e){var r=Ht.desc;return e&&!xt.isEmpty(e)&&(r+=" Details: "+e),new t(Ht.code,r)},t.createMultipleMatchingTokensInCacheError=function(e){return new t(Lt.code,"Cache error for scope "+e+": "+Lt.desc+".")},t.createMultipleAuthoritiesInCacheError=function(e){return new t(Mt.code,"Cache error for scope "+e+": "+Mt.desc+".")},t.createPopupWindowError=function(e){var r=zt.desc;return e&&!xt.isEmpty(e)&&(r+=" Details: "+e),new t(zt.code,r)},t.createTokenRenewalTimeoutError=function(){return new t(Ft.code,Ft.desc)},t.createInvalidIdTokenError=function(e){return new t(Bt.code,Bt.desc+" Given token: "+e)},t.createInvalidStateError=function(e,r){return new t(Vt.code,Vt.desc+" "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t(Qt.code,Qt.desc+" "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t(Wt.code,Wt.desc)},t.createAcquireTokenInProgressError=function(){return new t($t.code,$t.desc)},t.createUserCancelledError=function(){return new t(Gt.code,Gt.desc)},t.createErrorInCallbackFunction=function(e){return new t(Jt.code,Jt.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(Kt.code,Kt.desc)},t.createUserDoesNotExistError=function(){return new t(Xt.code,Xt.desc)},t.createClientInfoDecodingError=function(e){return new t(Yt.code,Yt.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(Zt.code,Zt.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(er.code,er.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(tr.code,tr.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(rr.code,rr.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(nr.code,nr.desc)},t}(Dt),ir={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},invalidCacheLocation:{code:"invalid_cache_location",desc:"The cache location provided is not valid."},noStorageSupported:{code:"browser_storage_not_supported",desc:"localStorage and sessionStorage are not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"}},ar=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return r(t,e),t.createNoSetConfigurationError=function(){return new t(ir.configurationNotSet.code,""+ir.configurationNotSet.desc)},t.createInvalidCacheLocationConfigError=function(e){return new t(ir.invalidCacheLocation.code,ir.invalidCacheLocation.desc+" Provided value: "+e+". Possible values are: "+yt.cacheLocationLocal+", "+yt.cacheLocationSession+".")},t.createNoStorageSupportedError=function(){return new t(ir.noStorageSupported.code,ir.noStorageSupported.desc)},t.createRedirectCallbacksNotSetError=function(){return new t(ir.noRedirectCallbacksSet.code,ir.noRedirectCallbacksSet.desc)},t.createInvalidCallbackObjectError=function(e){return new t(ir.invalidCallbackObject.code,ir.invalidCallbackObject.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(ir.emptyScopes.code,ir.emptyScopes.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(ir.nonArrayScopes.code,ir.nonArrayScopes.desc+" Given value: "+e+".")},t.createClientIdSingleScopeError=function(e){return new t(ir.clientScope.code,ir.clientScope.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(ir.scopesRequired.code,ir.scopesRequired.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(ir.invalidPrompt.code,ir.invalidPrompt.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(ir.claimsRequestParsingError.code,ir.claimsRequestParsingError.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=ir.emptyRequestError;return new t(e.code,e.desc)},t.createTelemetryConfigError=function(e){var r=ir.telemetryConfigError,n=r.code,o=r.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(n,o+" mising values: "+Object.keys(i).reduce(function(t,r){return e[r]?t:t.concat([r+" ("+i[r]+")"])},[]).join(","))},t}(or);var sr,cr=function(){function e(e,t,r,n,o,i){this.authorityInstance=e,this.clientId=t,this.scopes=r?r.slice():[t],this.nonce=mt.createNewGuid(),this.state=i&&!xt.isEmpty(i)?mt.createNewGuid()+"|"+i:mt.createNewGuid(),this.correlationId=mt.createNewGuid(),this.xClientSku="MSAL.JS",this.xClientVer="1.1.3",this.responseType=n,this.redirectUri=o}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n){var o,i={};r&&(r.prompt&&(this.validatePromptParameter(r.prompt),this.promptValue=r.prompt),r.claimsRequest&&(!function(e){if(e.claimsRequest)try{JSON.parse(e.claimsRequest)}catch(e){throw ar.createClaimsRequestParsingError(e)}}(r),this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i),r&&(o=this.sanitizeEQParams(r)),this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(o)},e.prototype.validatePromptParameter=function(e){if(!([At.LOGIN,At.SELECT_ACCOUNT,At.CONSENT,At.NONE].indexOf(e)>=0))throw ar.createInvalidPromptError(e)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n,o={};if(e)if(e.account){var i=e.account;i.sid?(r=bt,n=i.sid):i.userName&&(r=Tt,n=i.userName)}else e.sid?(r=bt,n=e.sid):e.loginHint&&(r=Tt,n=e.loginHint);else t&&(t.hasOwnProperty(yt.upn)?(r=Et,n=t.upn):(r=It,n=null));return o=this.addSSOParameter(r,n),e&&e.account&&e.account.homeAccountIdentifier&&(o=this.addSSOParameter(Ct,e.account.homeAccountIdentifier,o)),o},e.prototype.addHintParameters=function(e,t){if(e&&!t[bt]){if(!t[Tt]&&e.sid&&this.promptValue===At.NONE)t=this.addSSOParameter(bt,e.sid,t);else!t[Tt]&&e.userName&&!xt.isEmpty(e.userName)&&(t=this.addSSOParameter(Tt,e.userName,t));!t[Rt]&&!t[Pt]&&(t=this.addSSOParameter(Ct,e.homeAccountIdentifier,t))}return t},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case bt:r[bt]=t;break;case Et:r[Tt]=t,r[St]=It;break;case Tt:r[Tt]=t;break;case It:r[St]=It;break;case kt:r[St]=kt;break;case Ct:var n=t.split("."),o=mt.base64Decode(n[0]),i=mt.base64Decode(n[1]);r[Pt]=o,r[Rt]=i,i===yt.consumersUtid?r[St]=kt:r[St]=It;break;case Pt:r[Pt]=t;break;case Rt:r[Rt]=t}return r},e.prototype.sanitizeEQParams=function(e){var t=e.extraQueryParameters;return t?(e.claimsRequest&&delete t[yt.claims],_t.forEach(function(e){t[e]&&delete t[e]}),t):null},e.generateQueryParametersString=function(e){var t=null;return e&&Object.keys(e).forEach(function(r){null==t?t=r+"="+encodeURIComponent(e[r]):t+="&"+r+"="+encodeURIComponent(e[r])}),t},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e}(),ur=function(){function e(e){if(!e||xt.isEmpty(e))return this.uid="",void(this.utid="");try{var t=mt.base64Decode(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(e){throw or.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}(),lr=function(){function e(){}return e.decodeJwt=function(e){if(xt.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=mt.base64Decode(r);return n?JSON.parse(n):null}catch(e){}return null},e}(),dr=function(e){if(xt.isEmpty(e))throw or.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=lr.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid))}catch(e){throw or.createIdTokenParsingError(e)}},pr=function(e,t){this.key=e,this.value=t},hr=function(){function e(t){if(e.instance)return e.instance;if(this.cacheLocation=t,this.localStorageSupported=void 0!==window[this.cacheLocation]&&null!=window[this.cacheLocation],this.sessionStorageSupported=void 0!==window[t]&&null!=window[t],e.instance=this,!this.localStorageSupported&&!this.sessionStorageSupported)throw ar.createNoStorageSupportedError();return e.instance}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation]&&window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation]?window[this.cacheLocation].getItem(e):null},e.prototype.removeItem=function(e){if(window[this.cacheLocation])return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){if(window[this.cacheLocation])return window[this.cacheLocation].clear()},e.prototype.getAllAccessTokens=function(e,t){var r,n=[],o=window[this.cacheLocation];if(o){var i=void 0;for(i in o)if(o.hasOwnProperty(i)&&i.match(e)&&i.match(t)){var a=this.getItem(i);a&&(r=new pr(JSON.parse(i),JSON.parse(a)),n.push(r))}}return n},e.prototype.removeAcquireTokenEntries=function(e){var t=window[this.cacheLocation];if(t){var r=void 0;for(r in t)if(t.hasOwnProperty(r)&&!(-1===r.indexOf(gt)&&1===r.indexOf(vt)||e&&-1===r.indexOf(e))){var n=r.split(yt.resourceDelimiter),o=void 0;n.length>1&&(o=n[1]),o&&!this.tokenRenewalInProgress(o)&&(this.removeItem(r),this.removeItem(yt.renewStatus+o),this.removeItem(yt.stateLogin),this.removeItem(yt.stateAcquireToken),this.setItemCookie(r,"",-1))}}this.clearCookie()},e.prototype.tokenRenewalInProgress=function(e){var t=window[this.cacheLocation][yt.renewStatus+e];return!(!t||t!==yt.tokenRenewStatusInProgress)},e.prototype.resetCacheItems=function(){var e=window[this.cacheLocation];if(e){var t=void 0;for(t in e)e.hasOwnProperty(t)&&-1!==t.indexOf(yt.msal)&&this.removeItem(t);this.removeAcquireTokenEntries()}},e.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e.prototype.clearCookie=function(){this.setItemCookie(yt.nonceIdToken,"",-1),this.setItemCookie(yt.stateLogin,"",-1),this.setItemCookie(yt.loginRequest,"",-1),this.setItemCookie(yt.stateAcquireToken,"",-1)},e.generateAcquireTokenAccountKey=function(e,t){return vt+yt.resourceDelimiter+""+e+yt.resourceDelimiter+t},e.generateAuthorityKey=function(e){return gt+yt.resourceDelimiter+""+e},e}(),fr=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var n,o=t.objectId||t.subject,i=r?r.uid:"",a=r?r.utid:"";return xt.isEmpty(i)||xt.isEmpty(a)||(n=mt.base64Encode(i)+"."+mt.base64Encode(a)),new e(o,n,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}(),mr=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e}(),yr=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),n({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e}(),gr=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise(function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{var t=JSON.parse(i.responseText)}catch(e){o(n.handleError(i.responseText))}r(t)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()})},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}();!function(e){e[e.Aad=0]="Aad",e[e.Adfs=1]="Adfs",e[e.B2C=2]="B2C"}(sr||(sr={}));var vr,wr=function(e){function t(t,r){return e.call(this,t,r)||this}return r(t,e),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return sr.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise(function(t,r){return t(e.DefaultOpenIdConfigurationEndpoint)});if(!this.IsValidationEnabled)return t;var r=this.CanonicalAuthorityUrlComponents.HostNameAndPort;return this.IsInTrustedHostList(r)?t:(new gr).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(e){return e.tenant_discovery_endpoint})},t.prototype.IsInTrustedHostList=function(e){return wt[e.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t}(function(){function e(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=qt.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=qt.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw ir.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw ir.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw ir.authorityUriInvalidPath},e.prototype.DiscoverEndpoints=function(e){return(new gr).sendRequestAsync(e,"GET",!0).then(function(e){return{AuthorizationEndpoint:e.authorization_endpoint,EndSessionEndpoint:e.end_session_endpoint,Issuer:e.issuer}})},e.prototype.resolveEndpointsAsync=function(){var e=this,t="";return this.GetOpenIdConfigurationEndpointAsync().then(function(r){return t=r,e.DiscoverEndpoints(t)}).then(function(t){return e.tenantDiscoveryResponse=t,e})},e}()),br=function(e){function t(t,r){var n=e.call(this,t,r)||this,o=qt.GetUrlComponents(t),i=o.PathSegments;if(i.length<3)throw ir.b2cAuthorityUriInvalidPath;return n.CanonicalAuthority="https://"+o.HostNameAndPort+"/"+i[0]+"/"+i[1]+"/"+i[2]+"/",n}return r(t,e),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return sr.B2C},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise(function(t,r){return t(e.DefaultOpenIdConfigurationEndpoint)});return this.IsValidationEnabled?this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?t:new Promise(function(e,t){return t(ir.unsupportedAuthorityValidation)}):t},t.B2C_PREFIX="tfp",t}(wr),Tr=function(){function e(){}return e.DetectAuthorityFromUrl=function(e){switch(e=qt.CanonicalizeUri(e),qt.GetUrlComponents(e).PathSegments[0]){case"tfp":return sr.B2C;case"adfs":return sr.Adfs;default:return sr.Aad}},e.CreateInstance=function(t,r){if(xt.isEmpty(t))return null;switch(e.DetectAuthorityFromUrl(t)){case sr.B2C:return new br(t,r);case sr.Aad:return new wr(t,r);default:throw ir.invalidAuthorityType}},e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(vr||(vr={}));var Er=function(){function e(e,t){void 0===t&&(t={}),this.level=vr.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?vr.Info:o,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=n,this.level=i,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n,o=(new Date).toUTCString();n=xt.isEmpty(this.correlationId)?o+":1.1.3-"+vr[e]+" "+t:o+":"+this.correlationId+"-1.1.3-"+vr[e]+" "+t,this.executeCallback(e,n,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(vr.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(vr.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(vr.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(vr.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(vr.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(vr.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(vr.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(vr.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),Sr={clientId:"",authority:null,validateAuthority:!0,redirectUri:function(){return qt.getDefaultRedirectUri()},postLogoutRedirectUri:function(){return qt.getDefaultRedirectUri()},navigateToLoginRequestUrl:!0},Ir={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},kr={logger:new Er(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},Cr={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var Pr={code:"server_unavailable",desc:"Server is temporarily unavailable."},Rr={code:"unknown_server_error"},_r=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return r(t,e),t.createServerUnavailableError=function(){return new t(Pr.code,Pr.desc)},t.createUnknownServerError=function(e){return new t(Rr.code,e)},t}(Dt),Ar={code:"interaction_required"},Or={code:"consent_required"},xr={code:"login_required"},qr=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return r(t,e),t.isInteractionRequiredError=function(e){var t=[Ar.code,Or.code,xr.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(xr.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(Ar.code,e)},t.createConsentRequiredAuthError=function(e){return new t(Or.code,e)},t}(_r);function Nr(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e}}var Ur="event_name",jr="start_time",Dr="elapsed_time",Lr={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},Mr=function(e){return"msal."+(e||"")},Hr=function(e){function t(t,r,n,o){var i=e.call(this,Mr("default_event"),r)||this;return i.event[Mr("client_id")]=n,i.event[Mr("sdk_plaform")]=t.sdk,i.event[Mr("sdk_version")]=t.sdkVersion,i.event[Mr("application_name")]=t.applicationName,i.event[Mr("application_version")]=t.applicationVersion,i.event[""+Lr.UiEventCountTelemetryBatchKey]=i.getEventCount(Mr("ui_event"),o),i.event[""+Lr.HttpEventCountTelemetryBatchKey]=i.getEventCount(Mr("http_event"),o),i.event[""+Lr.CacheEventCountConstStrKey]=i.getEventCount(Mr("cache_event"),o),i}return r(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(function(){function e(e,t){var r;this.startTimestamp=Date.now(),this.eventId=mt.createNewGuid(),this.event=((r={})[Mr(Ur)]=e,r[Mr(jr)]=this.startTimestamp,r[Mr(Dr)]=-1,r[""+Lr.MsalCorrelationIdConstStrKey]=t,r)}return e.prototype.setElapsedTime=function(e){this.event[Mr(Dr)]=e},e.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+Lr.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+Lr.MsalCorrelationIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[Mr(Ur)]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return n({},this.event,{eventId:this.eventId})},e}()),zr=function(e){return e.telemetryCorrelationId+"-"+e.eventId+"-"+e.eventName},Fr=function(){function e(e,t){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=e.platform,this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t}return e.prototype.startEvent=function(e){if(this.telemetryEmitter){var t=zr(e);this.inProgressEvents[t]=e}},e.prototype.stopEvent=function(e){var t=zr(e);if(this.telemetryEmitter&&this.inProgressEvents[t]){e.stop(),this.incrementEventCount(e);var r=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(r||[]).concat([e]),delete this.inProgressEvents[t]}},e.prototype.flush=function(e){var t=this;if(this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach(function(e){return t.incrementEventCount(e)});var n=this.completedEvents[e].concat(r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=new Hr(this.telemetryPlatform,e,this.clientId,o),a=n.concat([i]);this.telemetryEmitter(a.map(function(e){return e.get()}))}}},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o])}return r},[])},e}(),Br="https://login.microsoftonline.com/common",Vr="id_token",Qr="token",Wr="id_token token",$r=function(e,t,r){var n=r.value;return r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isInIframe()?new Promise(function(){}):n.apply(this,e)},r},Gr=function(){function e(e){var t,r,o,i,a,s,c,u;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(r=(t=e).auth,o=t.cache,i=void 0===o?{}:o,a=t.system,s=void 0===a?{}:a,c=t.framework,u=void 0===c?{}:c,{auth:n({},Sr,r),cache:n({},Ir,i),system:n({},kr,s),framework:n({},Cr,u)}),this.redirectCallbacksSet=!1,this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),this.authority=this.config.auth.authority||Br,this.loginInProgress=!1,this.acquireTokenInProgress=!1;try{this.cacheStorage=new hr(this.config.cache.cacheLocation)}catch(e){throw ar.createInvalidCacheLocationConfigError(this.config.cache.cacheLocation)}window.openedWindows=[],window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var l=window.location.hash,d=this.urlContainsHash(l);this.config.framework.isAngular||d&&this.handleAuthenticationResponse(l)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=Tr.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw this.redirectCallbacksSet=!1,ar.createInvalidCallbackObjectError(e);if(t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectCallbacksSet=!0,!this.config.framework.isAngular){var r=this.cacheStorage.getItem(yt.urlHash);r&&this.processCallBack(r,null)}},e.prototype.authResponseHandler=function(e,t,r){if(e===yt.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(e!==yt.interactionTypePopup)throw or.createInvalidInteractionTypeError();r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(e===yt.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,r.accountState):this.authResponseCallback(t,r);else{if(e!==yt.interactionTypePopup)throw or.createInvalidInteractionTypeError();n(t)}},e.prototype.loginRedirect=function(e){if(!this.redirectCallbacksSet)throw ar.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(yt.interactionTypeRedirect,!0,e)},e.prototype.acquireTokenRedirect=function(e){if(!e)throw ar.createEmptyRequestError();if(!this.redirectCallbacksSet)throw ar.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(yt.interactionTypeRedirect,!1,e)},e.prototype.loginPopup=function(e){var t=this;return new Promise(function(r,n){t.acquireTokenInteractive(yt.interactionTypePopup,!0,e,r,n)})},e.prototype.acquireTokenPopup=function(e){var t=this;if(!e)throw ar.createEmptyRequestError();return new Promise(function(r,n){t.acquireTokenInteractive(yt.interactionTypePopup,!1,e,r,n)})},e.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i=this;if(this.loginInProgress||this.acquireTokenInProgress){var a=this.loginInProgress?or.createLoginInProgressError():or.createAcquireTokenInProgressError(),s=Nr(this.getAccountState(r&&r.state));this.authErrorHandler(e,a,s,o)}else{var c=t?this.appendScopes(r):r.scopes;this.validateInputScope(c,!t);var u=r&&r.account&&!t?r.account:this.getAccount();if(u||cr.isSSOParam(r))this.acquireTokenHelper(u,e,t,r,c,n,o);else{if(!t)throw this.logger.info("User login is required"),or.createUserLoginRequiredError();if(this.extractADALIdToken()&&!c){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken ");var l=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(l).then(function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,n)},function(a){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+a),i.acquireTokenHelper(null,e,t,r,c,n,o)})}else this.acquireTokenHelper(null,e,t,r,c,n,o)}}},e.prototype.acquireTokenHelper=function(e,t,r,n,o,i,a){var s=this;r?this.loginInProgress=!0:this.acquireTokenInProgress=!0;var c,u,l=o?o.join(" ").toLowerCase():this.clientId.toLowerCase(),d=!r&&n&&n.authority?Tr.CreateInstance(n.authority,this.config.auth.validateAuthority):this.authorityInstance;(t!==yt.interactionTypePopup||(u=this.openWindow("about:blank","_blank",1,this,i,a)))&&d.resolveEndpointsAsync().then(function(){var p,h=r?Vr:s.getTokenType(e,o,!1);r&&((p=s.cacheStorage.getItem(yt.angularLoginRequest))&&""!==p?s.cacheStorage.setItem(yt.angularLoginRequest,""):p=window.location.href),c=new cr(d,s.clientId,o,h,s.getRedirectUri(),n&&n.state),s.updateCacheEntries(c,e,p),c.populateQueryParams(e,n);var f=qt.createNavigateUrl(c)+yt.response_mode_fragment;if(t===yt.interactionTypeRedirect)r||s.cacheStorage.setItem(yt.stateAcquireToken,c.state,s.inCookie);else{if(t!==yt.interactionTypePopup)throw or.createInvalidInteractionTypeError();window.renewStates.push(c.state),window.requestType=r?yt.login:yt.renewToken,s.registerCallback(c.state,l,i,a)}s.navigateWindow(f,u)}).catch(function(e){s.logger.warning("could not resolve endpoints"),s.authErrorHandler(t,or.createEndpointResolutionError(e.toString),Nr(n.state),a),u&&u.close()})},e.prototype.acquireTokenSilent=function(e){var t=this;if(!e)throw ar.createEmptyRequestError();return new Promise(function(r,n){t.validateInputScope(e.scopes,!0);var o=e.scopes.join(" ").toLowerCase(),i=e.account||t.getAccount(),a=t.cacheStorage.getItem(yt.adalIdToken);if(!i&&!e.sid&&!e.loginHint&&xt.isEmpty(a))return t.logger.info("User login is required"),n(or.createUserLoginRequiredError());var s=t.getTokenType(i,e.scopes,!0),c=new cr(Tr.CreateInstance(e.authority,t.config.auth.validateAuthority),t.clientId,e.scopes,s,t.getRedirectUri(),e&&e.state);if(cr.isSSOParam(e)||i)c.populateQueryParams(i,e);else if(!i&&!xt.isEmpty(a)){var u=lr.extractIdToken(a);t.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken "),c.populateQueryParams(i,null,u)}var l,d,p=e.claimsRequest||c.claimsValue;if(!p&&!e.forceRefresh)try{d=t.getCachedToken(c,i)}catch(e){l=e}if(d)return t.logger.info("Token is already in cache for scope:"+o),r(d),null;if(l)return t.logger.infoPii(l.errorCode+":"+l.errorMessage),n(l),null;var h=void 0;return h=p?"Skipped cache lookup since claims were given.":e.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope:"+o,t.logger.verbose(h),c.authorityInstance||(c.authorityInstance=e.authority?Tr.CreateInstance(e.authority,t.config.auth.validateAuthority):t.authorityInstance),c.authorityInstance.resolveEndpointsAsync().then(function(){window.activeRenewals[o]?(t.logger.verbose("Renew token for scope: "+o+" is in progress. Registering callback"),t.registerCallback(window.activeRenewals[o],o,r,n)):e.scopes&&e.scopes.indexOf(t.clientId)>-1&&1===e.scopes.length?(t.logger.verbose("renewing idToken"),t.silentLogin=!0,t.renewIdToken(e.scopes,r,n,i,c)):(t.logger.verbose("renewing accesstoken"),t.renewToken(e.scopes,r,n,i,c))}).catch(function(e){return t.logger.warning("could not resolve endpoints"),n(or.createEndpointResolutionError(e.toString())),null})})},e.prototype.openWindow=function(e,t,r,n,o,i){var a,s=this;try{a=this.openPopup(e,t,yt.popUpWidth,yt.popUpHeight)}catch(e){return n.loginInProgress=!1,n.acquireTokenInProgress=!1,this.logger.info(zt.code+":"+zt.desc),this.cacheStorage.setItem(yt.msalError,zt.code),this.cacheStorage.setItem(yt.msalErrorDescription,zt.desc),i&&i(or.createPopupWindowError()),null}window.openedWindows.push(a);var c=window.setInterval(function(){if(a&&a.closed&&(n.loginInProgress||n.acquireTokenInProgress)){if(i&&i(or.createUserCancelledError()),window.clearInterval(c),s.config.framework.isAngular)return void s.broadcast("msal:popUpClosed",Gt.code+yt.resourceDelimiter+Gt.desc);n.loginInProgress=!1,n.acquireTokenInProgress=!1}try{var e=a.location;if(-1!==e.href.indexOf(s.getRedirectUri())&&(window.clearInterval(c),n.loginInProgress=!1,n.acquireTokenInProgress=!1,s.logger.info("Closing popup window"),s.config.framework.isAngular)){s.broadcast("msal:popUpHashChanged",e.hash);for(var t=0;t<window.openedWindows.length;t++)window.openedWindows[t].close()}}catch(e){}},r);return a},e.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=a/2-r/2+o,u=s/2-n/2+i,l=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+c);if(!l)throw or.createPopupWindowError();return l.focus&&l.focus(),l}catch(e){throw this.logger.error("error opening popup "+e.message),this.loginInProgress=!1,this.acquireTokenInProgress=!1,or.createPopupWindowError(e.toString())}},e.prototype.isInIframe=function(){return window.parent!==window},e.prototype.parentIsMsal=function(){return window.parent!==window&&window.parent.msal},e.prototype.loadIframeTimeout=function(e,t,r){var n=this,o=window.activeRenewals[r];this.logger.verbose("Set loading state to pending for: "+r+":"+o),this.cacheStorage.setItem(yt.renewStatus+o,yt.tokenRenewStatusInProgress),this.loadFrame(e,t),setTimeout(function(){n.cacheStorage.getItem(yt.renewStatus+o)===yt.tokenRenewStatusInProgress&&(n.logger.verbose("Loading frame has timed out after: "+n.config.system.loadFrameTimeout/1e3+" seconds for scope "+r+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,or.createTokenRenewalTimeoutError()),n.cacheStorage.setItem(yt.renewStatus+o,yt.tokenRenewStatusCancelled))},this.config.system.loadFrameTimeout)},e.prototype.loadFrame=function(e,t){var r=this;this.logger.info("LoadFrame: "+t);var n=t;setTimeout(function(){var o=r.addHiddenIFrame(n);""!==o.src&&"about:blank"!==o.src||(o.src=e,r.logger.infoPii("Frame Name : "+t+" Navigated to: "+e))},this.config.system.navigateFrameWait)},e.prototype.addHiddenIFrame=function(e){if(void 0===e)return null;this.logger.info("Add msal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var r=document.createElement("iframe");r.setAttribute("id",e),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",t=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(t=window.frames[e])}return t},e.prototype.navigateWindow=function(e,t){if(!e||xt.isEmpty(e))throw this.logger.info("Navigate url is empty"),Dt.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.replace(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw Dt.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(e){o.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(){var e=this;this.clearCache(),this.account=null;var t="";this.getPostLogoutRedirectUri()&&(t="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri())),this.authorityInstance.resolveEndpointsAsync().then(function(r){var n=r.EndSessionEndpoint?r.EndSessionEndpoint+"?"+t:e.authority+"oauth2/v2.0/logout?"+t;e.navigateWindow(n)})},e.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(yt.clientId,yt.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearCookie()},e.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(yt.clientId,yt.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.urlContainsHash(e)},e.prototype.urlContainsHash=function(e){var t=this.deserializeHash(e);return t.hasOwnProperty(yt.errorDescription)||t.hasOwnProperty(yt.error)||t.hasOwnProperty(yt.accessToken)||t.hasOwnProperty(yt.idToken)},e.prototype.processCallBack=function(e,t,r){var n,o;this.logger.info("Processing the callback from redirect response"),t||(t=this.getResponseState(e));try{n=this.saveTokenFromHash(e,t)}catch(e){o=e}this.cacheStorage.removeItem(yt.urlHash);try{this.cacheStorage.clearCookie();var i=this.getAccountState(t.state);if(n){if(t.requestType===yt.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),n.tokenType=yt.accessToken):t.requestType===yt.login&&(n.tokenType=yt.idToken),!r)return void this.authResponseHandler(yt.interactionTypeRedirect,n)}else if(!r)return void this.authErrorHandler(yt.interactionTypeRedirect,o,Nr(i));r(n,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),or.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){null==e&&(e=window.location.hash);var t=null,r=!1,n=!1;try{n=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(e){n=!1}n?(t=window.opener.msal,r=!0):window.parent&&window.parent.msal&&(t=window.parent.msal);var o=t.getResponseState(e),i=null;if(t.logger.info("Returned from redirect url"),this.parentIsMsal())i=window.parent.callbackMappedToRenewStates[o.state];else if(n)i=window.opener.callbackMappedToRenewStates[o.state];else{if(i=null,t.config.auth.navigateToLoginRequestUrl)return t.cacheStorage.setItem(yt.urlHash,e),void(window.parent!==window||r||(window.location.href=t.cacheStorage.getItem(yt.loginRequest,t.inCookie)));if(window.location.hash="",!this.redirectCallbacksSet)return void t.cacheStorage.setItem(yt.urlHash,e)}if(t.processCallBack(e,o,i),n)for(var a=0;a<window.opener.openedWindows.length;a++)window.opener.openedWindows[a].close()},e.prototype.deserializeHash=function(e){var t=qt.getHashFromUrl(e);return mt.deserialize(t)},e.prototype.getResponseState=function(e){var t,r=this.deserializeHash(e);if(!r)throw Dt.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty("state"))throw Dt.createUnexpectedError("Hash does not contain state.");if((t={requestType:yt.unknown,state:r.state,stateMatch:!1}).state===this.cacheStorage.getItem(yt.stateLogin,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=yt.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(yt.stateAcquireToken,this.inCookie))return t.requestType=yt.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var n=window.renewStates,o=0;o<n.length;o++)if(n[o]===t.state){t.stateMatch=!0;break}}return t},e.prototype.getCachedToken=function(e,t){var r=null,n=e.scopes,o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(a=0;a<o.length;a++){c=(s=o[a]).key.scopes.split(" ");Ot.containsScope(c,n)&&qt.CanonicalizeUri(s.key.authority)===e.authority&&i.push(s)}if(0===i.length)return null;if(1!==i.length)throw or.createMultipleMatchingTokensInCacheError(n.toString());r=i[0]}else{for(var a=0;a<o.length;a++){var s,c=(s=o[a]).key.scopes.split(" ");Ot.containsScope(c,n)&&i.push(s)}if(1===i.length)r=i[0],e.authorityInstance=Tr.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(i.length>1)throw or.createMultipleMatchingTokensInCacheError(n.toString());var u=this.getUniqueAuthority(o,"authority");if(u.length>1)throw or.createMultipleAuthoritiesInCacheError(n.toString());e.authorityInstance=Tr.CreateInstance(u[0],this.config.auth.validateAuthority)}}if(null!=r){var l=Number(r.value.expiresIn),d=this.config.system.tokenRenewalOffsetSeconds||300;if(l&&l>mr.now()+d){var p=new dr(r.value.idToken);if(!t&&!(t=this.getAccount()))throw Dt.createUnexpectedError("Account should not be null here.");var h=this.getAccountState(e.state),f={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?yt.idToken:yt.accessToken,idToken:p,idTokenClaims:p.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*l),account:t,accountState:h};return yr.setResponseIdToken(f,p),f}return this.cacheStorage.removeItem(JSON.stringify(i[0].key)),null}return null},e.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))}),r},e.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(yt.adalIdToken);return xt.isEmpty(e)?null:lr.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){var i=e.join(" ").toLowerCase();this.logger.verbose("renewToken is called for scope:"+i);var a=this.addHiddenIFrame("msalRenewFrame"+i);this.updateCacheEntries(o,n),this.logger.verbose("Renew token Expected state: "+o.state);var s=qt.urlRemoveQueryStringParameter(qt.createNavigateUrl(o),yt.prompt)+yt.prompt_none;window.renewStates.push(o.state),window.requestType=yt.renewToken,this.registerCallback(o.state,i,t,r),this.logger.infoPii("Navigate to:"+s),a.src="about:blank",this.loadIframeTimeout(s,"msalRenewFrame"+i,i)},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("renewidToken is called");var i=this.addHiddenIFrame("msalIdTokenFrame");this.updateCacheEntries(o,n),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var a=qt.urlRemoveQueryStringParameter(qt.createNavigateUrl(o),yt.prompt)+yt.prompt_none;this.silentLogin?(window.requestType=yt.login,this.silentAuthenticationState=o.state):(window.requestType=yt.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,this.clientId,t,r),this.logger.infoPii("Navigate to:"+a),i.src="about:blank",this.loadIframeTimeout(a,"msalIdTokenFrame",this.clientId)},e.prototype.saveAccessToken=function(e,t,r,o,i){var a,s,c=n({},e),u=new ur(o);if(r.hasOwnProperty("scope")){for(var l=(a=r.scope).split(" "),d=this.cacheStorage.getAllAccessTokens(this.clientId,t),p=0;p<d.length;p++){var h=d[p];if(h.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var f=h.key.scopes.split(" ");Ot.isIntersectingScopes(f,l)&&this.cacheStorage.removeItem(JSON.stringify(h.key))}}var m=mr.parseExpiresIn(r[yt.expiresIn]);s=mr.now()+m;var y=new Nt(t,this.clientId,a,u.uid,u.utid),g=new Ut(r[yt.accessToken],i.rawIdToken,s.toString(),o);this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(g)),c.accessToken=r[yt.accessToken],c.scopes=l}else{a=this.clientId;y=new Nt(t,this.clientId,a,u.uid,u.utid);s=Number(i.expiration);g=new Ut(r[yt.idToken],r[yt.idToken],s.toString(),o);this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(g)),c.scopes=[a],c.accessToken=r[yt.idToken]}return s?c.expiresOn=new Date(1e3*s):this.logger.error("Could not parse expiresIn parameter"),c},e.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType),this.cacheStorage.setItem(yt.msalError,""),this.cacheStorage.setItem(yt.msalErrorDescription,"");var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:""},o=this.deserializeHash(e),i="",a="",s=null;if(o.hasOwnProperty(yt.errorDescription)||o.hasOwnProperty(yt.error)){if(this.logger.infoPii("Error :"+o[yt.error]+"; Error description:"+o[yt.errorDescription]),this.cacheStorage.setItem(yt.msalError,o[yt.error]),this.cacheStorage.setItem(yt.msalErrorDescription,o[yt.errorDescription]),t.requestType===yt.login&&(this.loginInProgress=!1,this.cacheStorage.setItem(yt.loginError,o[yt.errorDescription]+":"+o[yt.error]),i=hr.generateAuthorityKey(t.state)),t.requestType===yt.renewToken){this.acquireTokenInProgress=!1,i=hr.generateAuthorityKey(t.state);var c=this.getAccount(),u=void 0;u=c&&!xt.isEmpty(c.homeAccountIdentifier)?c.homeAccountIdentifier:yt.no_account,a=hr.generateAcquireTokenAccountKey(u,t.state)}var l=o[yt.error],d=o[yt.errorDescription];r=qr.isInteractionRequiredError(l)||qr.isInteractionRequiredError(d)?new qr(o[yt.error],o[yt.errorDescription]):new _r(o[yt.error],o[yt.errorDescription])}else if(t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(yt.sessionState)&&this.cacheStorage.setItem(yt.msalSessionState,o[yt.sessionState]),n.accountState=this.getAccountState(t.state);var p="";if(o.hasOwnProperty(yt.accessToken)){this.logger.info("Fragment has access token"),this.acquireTokenInProgress=!1,o.hasOwnProperty(yt.idToken)?(s=new dr(o[yt.idToken]),n.idToken=s,n.idTokenClaims=s.claims):(s=new dr(this.cacheStorage.getItem(yt.idTokenKey)),n=yr.setResponseIdToken(n,s));var h=hr.generateAuthorityKey(t.state),f=this.cacheStorage.getItem(h,this.inCookie);if(xt.isEmpty(f)||(f=qt.replaceTenantPath(f,n.tenantId)),!o.hasOwnProperty(yt.clientInfo))throw this.logger.warning("ClientInfo not received in the response from AAD"),or.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");p=o[yt.clientInfo],n.account=fr.createAccount(s,new ur(p));var m=void 0;m=n.account&&!xt.isEmpty(n.account.homeAccountIdentifier)?n.account.homeAccountIdentifier:yt.no_account,a=hr.generateAcquireTokenAccountKey(m,t.state);var y=hr.generateAcquireTokenAccountKey(yt.no_account,t.state),g=this.cacheStorage.getItem(a),v=void 0;xt.isEmpty(g)?xt.isEmpty(this.cacheStorage.getItem(y))||(n=this.saveAccessToken(n,f,o,p,s)):(v=JSON.parse(g),n.account&&v&&fr.compareAccounts(n.account,v)?(n=this.saveAccessToken(n,f,o,p,s),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(yt.idToken)){this.logger.info("Fragment has id token"),this.loginInProgress=!1,s=new dr(o[yt.idToken]),n=yr.setResponseIdToken(n,s),o.hasOwnProperty(yt.clientInfo)?p=o[yt.clientInfo]:this.logger.warning("ClientInfo not received in the response from AAD"),i=hr.generateAuthorityKey(t.state);f=this.cacheStorage.getItem(i,this.inCookie);xt.isEmpty(f)||(f=qt.replaceTenantPath(f,s.tenantId)),this.account=fr.createAccount(s,new ur(p)),n.account=this.account,s&&s.nonce?s.nonce!==this.cacheStorage.getItem(yt.nonceIdToken,this.inCookie)?(this.account=null,this.cacheStorage.setItem(yt.loginError,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(yt.nonceIdToken,this.inCookie)+",Actual Nonce: "+s.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(yt.nonceIdToken,this.inCookie)+",Actual Nonce: "+s.nonce),r=or.createNonceMismatchError(this.cacheStorage.getItem(yt.nonceIdToken,this.inCookie),s.nonce)):(this.cacheStorage.setItem(yt.idTokenKey,o[yt.idToken]),this.cacheStorage.setItem(yt.msalClientInfo,p),this.saveAccessToken(n,f,o,p,s)):(i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=or.createInvalidIdTokenError(s),this.cacheStorage.setItem(yt.msalError,r.errorCode),this.cacheStorage.setItem(yt.msalErrorDescription,r.errorMessage))}}else{i=t.state,a=t.state;var w=this.cacheStorage.getItem(yt.stateLogin,this.inCookie);this.logger.error("State Mismatch.Expected State: "+w+",Actual State: "+t.state),r=or.createInvalidStateError(t.state,w),this.cacheStorage.setItem(yt.msalError,r.errorCode),this.cacheStorage.setItem(yt.msalErrorDescription,r.errorMessage)}if(this.cacheStorage.setItem(yt.renewStatus+t.state,yt.tokenRenewStatusCompleted),this.cacheStorage.removeAcquireTokenEntries(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearCookie()),r)throw r;if(!n)throw Dt.createUnexpectedError("Response is null");return n},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(yt.idTokenKey),t=this.cacheStorage.getItem(yt.msalClientInfo);if(!xt.isEmpty(e)&&!xt.isEmpty(t)){var r=new dr(e),n=new ur(t);return this.account=fr.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(yt.clientId,yt.homeAccountIdentifier),r=0;r<t.length;r++){var n=new dr(t[r].value.idToken),o=new ur(t[r].value.homeAccountIdentifier),i=fr.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw ar.createScopesNonArrayError(e);if(e.length<1)throw ar.createEmptyScopesArrayError(e.toString());if(e.indexOf(this.clientId)>-1&&e.length>1)throw ar.createClientIdSingleScopeError(e.toString())}else if(t)throw ar.createScopesRequiredError(e)},e.prototype.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.prototype.appendScopes=function(e){var t;return e&&e.scopes&&(t=e.extraScopesToConsent?e.scopes.concat(e.extraScopesToConsent):e.scopes),t},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r){var n=t||this.getAccount();if(!n)return null;var o=this.authorityInstance?this.authorityInstance:Tr.CreateInstance(this.authority,this.config.auth.validateAuthority),i=this.getTokenType(n,e,!0),a=new cr(o,this.clientId,e,i,this.getRedirectUri(),r);return this.getCachedToken(a,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this.getHostFromUri(e)===this.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return!!this.cacheStorage.getItem(yt.urlHash)||this.loginInProgress},e.prototype.setloginInProgress=function(e){this.loginInProgress=e},e.prototype.getAcquireTokenInProgress=function(){return this.acquireTokenInProgress},e.prototype.setAcquireTokenInProgress=function(e){this.acquireTokenInProgress=e},e.prototype.getLogger=function(){return this.config.system.logger},e.prototype.getRedirectUri=function(){return"function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw ar.createNoSetConfigurationError();return this.config},e.prototype.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e.prototype.getTokenType=function(e,t,r){return r?fr.compareAccounts(e,this.getAccount())?t.indexOf(this.config.auth.clientId)>-1?Vr:Qr:t.indexOf(this.config.auth.clientId)>-1?Vr:Wr:fr.compareAccounts(e,this.getAccount())?t.indexOf(this.clientId)>-1?Vr:Qr:Wr},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):yt.no_account,n=hr.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=hr.generateAuthorityKey(e);this.cacheStorage.setItem(r,qt.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r){r?(this.cacheStorage.setItem(yt.loginRequest,r,this.inCookie),this.cacheStorage.setItem(yt.loginError,""),this.cacheStorage.setItem(yt.stateLogin,e.state,this.inCookie),this.cacheStorage.setItem(yt.msalError,""),this.cacheStorage.setItem(yt.msalErrorDescription,"")):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(yt.nonceIdToken,e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return xt.isEmpty(e.homeAccountIdentifier)?yt.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return null;var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw ar.createTelemetryConfigError(e);return new Fr({platform:{sdk:"msal.js",sdkVersion:"1.1.3",applicationName:r,applicationVersion:n},clientId:t},o)},function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);i>3&&a&&Object.defineProperty(t,r,a)}([$r],e.prototype,"acquireTokenSilent",null),e}();const Jr=new Error("DeviceCodeCredential is not supported in the browser.");e.AggregateAuthenticationError=s,e.AuthenticationError=a,e.ChainedTokenCredential=c,e.ClientCertificateCredential=class{constructor(e,t,r,n){throw ft}getToken(e,t){throw ft}},e.ClientSecretCredential=class{constructor(e,t,r,n){this.identityClient=new ht(n),this.tenantId=e,this.clientId=t,this.clientSecret=r}getToken(e,t){return o(this,void 0,void 0,function*(){const r=this.identityClient.createWebResource({url:`${this.identityClient.authorityHost}/${this.tenantId}/oauth2/v2.0/token`,method:"POST",disableJsonStringifyOnBody:!0,deserializationMapper:void 0,body:j.stringify({response_type:"token",grant_type:"client_credentials",client_id:this.clientId,client_secret:this.clientSecret,scope:"string"==typeof e?e:e.join(" ")}),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},abortSignal:t&&t.abortSignal}),n=yield this.identityClient.sendTokenRequest(r);return n&&n.accessToken||null})}},e.DefaultAzureCredential=h,e.DeviceCodeCredential=class{constructor(e,t,r,n){throw Jr}getToken(e,t){throw Jr}},e.EnvironmentCredential=l,e.InteractiveBrowserCredential=class{constructor(e,t,r){if(r=Object.assign({},ht.getDefaultOptions(),r),this.loginStyle=r.loginStyle||"popup",-1===["redirect","popup"].indexOf(this.loginStyle))throw new Error(`Invalid loginStyle: ${r.loginStyle}`);this.msalConfig={auth:Object.assign({clientId:t,authority:`${r.authorityHost}/${e}`},r.redirectUri&&{redirectUri:r.redirectUri},r.postLogoutRedirectUri&&{redirectUri:r.postLogoutRedirectUri}),cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}},this.msalObject=new Gr(this.msalConfig)}login(){switch(this.loginStyle){case"redirect":{const e=new Promise((e,t)=>{this.msalObject.handleRedirectCallback(e,t)});return this.msalObject.loginRedirect(),e}case"popup":return this.msalObject.loginPopup()}}acquireToken(e){return o(this,void 0,void 0,function*(){let t,r;try{t=yield this.msalObject.acquireTokenSilent(e)}catch(e){if(e instanceof Dt)switch(e.errorCode){case"consent_required":case"interaction_required":case"login_required":break;default:throw e}}if(void 0===t){switch(this.loginStyle){case"redirect":r=new Promise((e,t)=>{this.msalObject.handleRedirectCallback(e,t)}),this.msalObject.acquireTokenRedirect(e);break;case"popup":r=this.msalObject.acquireTokenPopup(e)}t=r&&(yield r)}return t})}getToken(e,t){return o(this,void 0,void 0,function*(){this.msalObject.getAccount()||(yield this.login());const t=yield this.acquireToken({scopes:Array.isArray(e)?e:e.split(",")});return t?{token:t.accessToken,expiresOnTimestamp:t.expiresOn.getTime()}:null})}},e.ManagedIdentityCredential=p,e.UsernamePasswordCredential=class{constructor(e,t,r,n,o){this.identityClient=new ht(o),this.tenantId=e,this.clientId=t,this.username=r,this.password=n}getToken(e,t){return o(this,void 0,void 0,function*(){const r=this.identityClient.createWebResource({url:`${this.identityClient.authorityHost}/${this.tenantId}/oauth2/v2.0/token`,method:"POST",disableJsonStringifyOnBody:!0,deserializationMapper:void 0,body:j.stringify({response_type:"token",grant_type:"password",client_id:this.clientId,username:this.username,password:this.password,scope:"string"==typeof e?e:e.join(" ")}),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},abortSignal:t&&t.abortSignal}),n=yield this.identityClient.sendTokenRequest(r);return n&&n.accessToken||null})}},e.getDefaultAzureCredential=function(){return new h},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=identity.min.js.map
