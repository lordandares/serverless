"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getIssueDetails = getIssueDetails;

var _lodash = require("lodash");

var _momentTimezone = _interopRequireDefault(require("moment-timezone"));

var _ = require("../");

function getIssueDetails(data) {
  const {
    entity,
    timezone,
    users
  } = data;
  const {
    assignees,
    createdAt,
    duration,
    gps,
    status,
    user
  } = entity;
  const assigneeNames = (0, _.getAssigneesFullNames)(users, assignees);

  const durationInMins = _momentTimezone.default.duration(duration, 'minutes');

  const durationText = (0, _.getPrettyDuration)(durationInMins);
  const fullName = (0, _.getUserFullName)(users, user);
  const gpsText = (0, _lodash.get)(gps, 'reverseGeocoded.label', 'Unknown Location');
  const isClosedStatus = status === 'closed';
  const locationText = (0, _.getLocationReference)(data);
  const statusDetails = (0, _.getStatusDetails)(status);
  const statusStyle = statusDetails.style;
  const statusColor = statusStyle.color;
  const statusText = (0, _lodash.upperCase)(statusDetails.text);
  const timezoneDatetime = (0, _.getTimezoneDatetime)({
    timestamp: createdAt,
    timezone
  });
  return {
    assigneeNames,
    durationText,
    gpsText,
    fullName,
    isClosedStatus,
    locationText,
    statusStyle,
    statusColor,
    statusText,
    timezoneDatetime
  };
}